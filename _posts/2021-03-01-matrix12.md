---
layout:     post
title:      C++构建Matrix类(11)
subtitle:   实现QR分解，SVD分解
date:       2021-03-01
author:     Welt Xing
header-img: img/matrix_equations.png
catalog:    true
categories: matrix-c
tags:
    - matrix-c
    - 线性代数
---

# matrix-c实现QR分解和SVD分解

## QR分解

我们在之前提到过$QR$分解，其在求解矩阵特征值算法发挥重要作用，但当时只提供了分解的$QR$分解的接口，并没有详细讲解其分解的实现方法，我们这里来进行解释。

### 形式

QR分解将一个$m\times n(m\geq n)$矩阵分解为一个正交矩阵与一个上三角矩阵的积：

$$
A=QR\tag{1}
$$

Q是正交矩阵：

$$
Q^\top Q=I\tag{2}
$$

### 算法

QR分解的实际计算有很多方法，例如Givens旋转、Householder变换，以及Gram-Schmidt正交化等等。每一种方法都有其优点和不足。`matrix-c`采用施密特正交化进行求解。

我们可以用列向量的视角来看$QR$分解：

$$
\begin{aligned}
\begin{bmatrix}
\alpha_1&\alpha_2&\cdots&\alpha_n
\end{bmatrix}&=\begin{bmatrix}
\beta_1&\beta_2&\cdots&\beta_n
\end{bmatrix}\begin{bmatrix}
a_{11}&a_{12}&\cdots&a_{1n}\\
0&a_{22}&\cdots&a_{2n}\\
0 & 0&\ddots&a_{3n}\\
\vdots&\vdots&\vdots&\vdots\\
0&0&\cdots&a_{nn}
\end{bmatrix}\\
\end{aligned}\tag{3}
$$

可以证明上三角矩阵的逆矩阵还是上三角矩阵，所以我们可以得到：

$$
\begin{aligned}
\begin{bmatrix}
\alpha_1&\alpha_2&\cdots&\alpha_n
\end{bmatrix}\begin{bmatrix}
b_{11}&b_{12}&\cdots&b_{1n}\\
0&b_{22}&\cdots&b_{2n}\\
0 & 0&\ddots&b_{3n}\\
\vdots&\vdots&\vdots&\vdots\\
0&0&\cdots&b_{nn}
\end{bmatrix}&=\begin{bmatrix}
\beta_1&\beta_2&\cdots&\beta_n
\end{bmatrix}\\
&=\begin{bmatrix}
b_{11}\alpha_{1}&b_{12}\alpha_1+b_{22}\alpha_2&\cdots&\sum_{i=1}^nb_{in}\alpha_n
\end{bmatrix}
\end{aligned}\tag{4}
$$

也就是说，对于正交矩阵中的第$i$列向量$\beta_i$，我们可以通过$\alpha_1\sim\alpha_i$的线性组合得到，这正是施密特正交化的流程，在已有正交基的基础上构造一个新的正交基：![Schmidt](/img/Schmidt.jpg)

这里$\begin{bmatrix}\eta_1&\eta_2&\cdots&\eta_n\end{bmatrix}$就是一组标准正交基。

#### 实现施密特正交化

