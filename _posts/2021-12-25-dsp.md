---
layout:     post
title:      数字信号处理复习
date:       2021-12-25
author:     Welt Xing
header-img: img/dsp/background.jpg
catalog:    true
tags:
   - 数字信号处理
   - 课程
---

- [概念，性质和基本信号](#概念性质和基本信号)
  - [离散信号周期性](#离散信号周期性)
  - [信号分类](#信号分类)
  - [信号的运算](#信号的运算)
  - [典型信号](#典型信号)
  - [离散信号的差分与求和](#离散信号的差分与求和)
  - [奇异信号](#奇异信号)
  - [冲激信号](#冲激信号)
  - [信号的微积分](#信号的微积分)
- [系统的描述和卷积的引入](#系统的描述和卷积的引入)
  - [系统的分类与描述](#系统的分类与描述)
    - [描述](#描述)
    - [分类](#分类)
  - [卷积](#卷积)
    - [卷积的性质](#卷积的性质)
  - [使用卷积分析系统](#使用卷积分析系统)
  - [利用卷积判断系统的性质](#利用卷积判断系统的性质)
  - [卷积与相关](#卷积与相关)
- [微分方程、差分方程的求解](#微分方程差分方程的求解)
  - [引入](#引入)
  - [微分方程求解](#微分方程求解)
    - [求齐次解](#求齐次解)
    - [求特解](#求特解)
    - [求待定系数](#求待定系数)
  - [差分方程求解](#差分方程求解)
- [系统分解和卷积的应用](#系统分解和卷积的应用)
  - [系统响应的两种视角](#系统响应的两种视角)
  - [利用卷积求解LTI系统的响应](#利用卷积求解lti系统的响应)
  - [冲激响应求解](#冲激响应求解)
- [傅里叶级数](#傅里叶级数)
  - [三角傅里叶级数](#三角傅里叶级数)
    - [例子](#例子)
  - [指数傅里叶级数](#指数傅里叶级数)
    - [例子](#例子-1)
- [傅里叶变换](#傅里叶变换)
  - [推导](#推导)
  - [例子](#例子-2)
  - [周期信号下的傅里叶变换](#周期信号下的傅里叶变换)
  - [性质以及证明](#性质以及证明)
    - [线性性质](#线性性质)
    - [对称性](#对称性)
    - [展缩特性](#展缩特性)
    - [时移特性](#时移特性)
    - [频移特性](#频移特性)
    - [时域卷积特性](#时域卷积特性)
    - [频域卷积特性](#频域卷积特性)
    - [时域微分特性](#时域微分特性)
    - [频域微分特性](#频域微分特性)
- [信号的抽样](#信号的抽样)
  - [时域采样](#时域采样)
  - [频域采样](#频域采样)
  - [采样定理](#采样定理)
- [信号的调制与解调](#信号的调制与解调)
  - [信号调制](#信号调制)
  - [单边带调幅](#单边带调幅)
  - [同步解调](#同步解调)
  - [系统频谱分析](#系统频谱分析)
- [离散信号的傅里叶分析](#离散信号的傅里叶分析)
  - [离散时间傅里叶变换](#离散时间傅里叶变换)
  - [离散傅里叶级数](#离散傅里叶级数)
    - [四种变换的关系](#四种变换的关系)
  - [离散傅里叶变换](#离散傅里叶变换)
    - [离散傅里叶变换的性质](#离散傅里叶变换的性质)
      - [循环卷积](#循环卷积)
  - [快速傅里叶变换](#快速傅里叶变换)
    - [利用FFT实现IFFT](#利用fft实现ifft)
- [拉普拉斯变换](#拉普拉斯变换)
  - [单边拉普拉斯变换](#单边拉普拉斯变换)
    - [小记:如何看待复指数中的虚数项](#小记如何看待复指数中的虚数项)
  - [拉普拉斯变换的计算](#拉普拉斯变换的计算)
    - [小记:以收敛域的视角看傅里叶变换](#小记以收敛域的视角看傅里叶变换)
  - [拉普拉斯变换的性质](#拉普拉斯变换的性质)
    - [线性特性](#线性特性)
    - [展缩特性](#展缩特性-1)
    - [时移特性](#时移特性-1)
    - [综合运用](#综合运用)
    - [卷积特性](#卷积特性)
    - [乘积特性](#乘积特性)
    - [微分特性](#微分特性)
    - [积分特性](#积分特性)
    - [综合运用](#综合运用-1)
    - [初值定理和终值定理](#初值定理和终值定理)
    - [拉普拉斯变换和傅里叶变换的关系](#拉普拉斯变换和傅里叶变换的关系)
  - [拉普拉斯逆变换](#拉普拉斯逆变换)
    - [情况1](#情况1)
    - [情况2](#情况2)
    - [情况3](#情况3)
  - [拉普拉斯变换求解系统](#拉普拉斯变换求解系统)
  - [零极点与时域特性](#零极点与时域特性)
- [Z变换](#z变换)
  - [单边Z变换](#单边z变换)
  - [双边Z变换](#双边z变换)
  - [Z变换的性质](#z变换的性质)
    - [线性特性](#线性特性-1)
    - [位移特性](#位移特性)
    - [指数加权](#指数加权)
    - [Z域微分特性](#z域微分特性)
    - [序列卷积](#序列卷积)
    - [初值定理与终值定理](#初值定理与终值定理)
    - [总结](#总结)
  - [Z逆变换](#z逆变换)
  - [Z变换求解系统](#z变换求解系统)

## 概念，性质和基本信号

连续信号：

$$
x(t+T)=x(t)
$$

离散信号：

$$
x[n+N]=x[n]
$$

最小的$T$和$N$是在数学中叫最小正周期，而在数字信号处理中称作**基波周期**。

重要性质：

- 两周期信号的周期比$T_1/T_2$是有理数，其和信号仍是周期信号，其周期为两周期的最小公倍数。

例如

$$
x_1(t)=\sin 2t+\cos 3t
$$

周期比$\pi/\frac23\pi=\frac32$是有理数，因此和信号$x_1$仍是周期信号，周期为$2\pi$。相反的，

$$
x_2(t)=\cos 2t+\sin\pi t
$$

就不是周期信号。

- 周期信号可能分解为周期信号，非周期信号也可能分解为周期信号。

### 离散信号周期性

离散信号可理解为连续信号和周期脉冲相乘

![image-20211004235258754](/img/image-20211004235258754.png)

- 连续正弦信号一定是周期信号，而正弦序列不一定是周期序列。两连续周期信号之和不一定是周期信号，而**两周期序列之和一定是周期序列**。

### 信号分类

定义连续和离散信号的能量与功率：

$$
\begin{aligned}
W_{\text{continuous}}&=\lim_{T\to\infty}\int_{-T}^T\vert
x(t)
\vert^2\mathrm dt\\
W_{\text{discrete}}&=\lim_{N\to\infty}\sum_{-N}^{N}\vert
x[n]
\vert^2\\
P_{\text{continuous}}&=\dfrac{1}{2T}\lim_{T\to\infty}\int_{-T}^T\vert
x(t)
\vert^2\mathrm dt\\
P_{\text{discrete}}&=\dfrac{1}{2N+1}\lim_{N\to\infty}\sum_{-N}^{N}\vert
x[n]
\vert^2\\
\end{aligned}
$$

由此定义能量信号：能量有界，功率为0的信号；以及功率信号：能量无界，功率有限。

> 直流信号与周期信号都是功率信号.

信号𝑥(𝑡)可以是一个既非功率信号，又非能量信号。但一个信号不可能同时既是功率信号，又是能量信号。

> 周期信号都是功率信号.

常用分类：

- 因果信号：时间零点之前信号值全为0；
- 一维/多维信号：函数值维度；
- 连续信号和离散信号；
- 确定信号和随机信号。

### 信号的运算

信号的尺度变换、翻转、时移和函数的伸缩、翻转和平移等价。

信号的相加和相乘：

$$
x(t)=x_1(t)+x_2(t)\\
x(t)=x_1(t)\cdot x_2(t)
$$

### 典型信号

- 直流信号，$x(t)=A,t\in(-\infty,\infty)$

- 正弦信号，$x(t)=A\sin(w_0t+\varphi)$

- 实指数信号，$x(t)=Ae^{\alpha t}$

- 虚指数信号，$x(t)=Ae^{\alpha t}$, $\alpha$是纯虚数，因此可以写成$x(t)=Ae^{jw_0t}$，当$w_0\neq0$时，其具有周期性：

  $$
  T_0=\dfrac{2\pi}{\vert\omega_0\vert}
  $$

  其可以根据欧拉公式

  $$
  e^{ix}=\cos x+i\sin x
  $$

  因此虚指数信号可以分解成

  $$
  x(t)=A(\cos\omega_0t+j\sin\omega_0t)
  $$

- 复指数信号，$x(t)=Ae^{st}$，$A$用极坐标表示，$s$用笛卡尔坐标表示：

  $$
  \begin{aligned}
  x(t)&=\vert A\vert e^{j\theta}\cdot e^{(r+j\omega_0)t}\\
  &=\vert{A}\vert e^{rt}\cdot e^{j(\omega_0 t+\theta)}\\
  &=\vert{A}\vert e^{rt}\big(\cos(\omega_0 t+\theta)+j\sin(\omega_0 t+\theta)\big)\\
  &=\vert{A}\vert e^{rt}\cos(\omega_0 t+\theta)+j\vert{A}\vert e^{rt}\sin(\omega_0 t+\theta)
  \end{aligned}
  $$

  其中具有指数衰减振幅的正弦信号常称为*阻尼正弦振荡*。

- 抽样信号：$\text{Sa}(t)=\dfrac{\sin t}{t}$，一个重要的性质之一就是其积分

  $$
  \int_{-\infty}^\infty\text{Sa}(t)\mathrm dt=\pi\\
  \int_{0}^\infty\text{Sa}(t)\mathrm dt=\dfrac{\pi}2
  $$

下面是一些离散时间序列：

- 实指数序列、虚指数序列和复指数序列，我们仍然可以像上面那样进行分解。

  对于一个虚指数序列

  $$
  x[n]=e^{j\omega_0n}
  $$

  其频率振荡的周期性，也就是$\omega_0$的周期性是存在的：

  $$
  \begin{aligned}
  e^{j(\omega_0+2\pi)n}
  &=e^{j\omega_0n}e^{j2\pi n}\\
  &=e^{j\omega_0n}(\cos(2\pi n)+j\sin(2\pi n))\\
  &=e^{j\omega_0n}
  \end{aligned}
  $$
  因此不存在随$\omega_0$增加而增加**震荡速率**的性质
  
  ![image-20211005110306547](/img/image-20211005110306547.png)

![image-20211005110337459](/img/image-20211005110337459.png)

现在考察虚指数序列关于时间的周期性：

$$
\begin{aligned}
e^{j\omega_0(n+N)}&=e^{j\omega_0n}e^{j\omega_0N}\\
&=e^{j\omega_0n}\\
&\to e^{j\omega_0N}=1\\
&\to\cos\omega_0N=1\\
&\to\omega_0N=m2\pi
\end{aligned}
$$

因此要虚指数离散信号具有关于时间的周期性需要满足$\omega_0N=m2\pi$，𝑚为与𝑁互质的正整数。

- 离散时间单位脉冲

  $$
  \delta[n]=\begin{cases}
  1&n=0\\
  0&n\neq0
  \end{cases}
  $$

  使用单位脉冲和它的时移，可以表示任意的离散信号。

- 离散时间单位阶跃

  $$
  u[n]=\begin{cases}
  1&n\geq0\\
  0&n\lt0
  \end{cases}
  $$

  单位阶跃和单位脉冲可以互相表示：

  $$
  \begin{aligned}
  \delta[n]&=u[n]-u[n-1]\\
  u[n]&=\sum_{m=-\infty}^n\delta[m]
  \end{aligned}
  $$

- 矩形序列：
  
  $$
  r[n]=\begin{cases}
  1&0\leq n\leq N-1\\
  0&\text{otherwise}
  \end{cases}
  $$

  用单位阶跃和单位脉冲表示：$r[n]=u[n]-u[n-N]=\sum_{k=0}^{N-1}\delta[n-k]$.

- 斜变序列$x[n]=nu[n]$:

  ![image-20211005165526752](/img/image-20211005165526752.png)

### 离散信号的差分与求和

求和很简单：

$$
\sum_{k=-\infty}^n x[n]
$$

差分有前向和反向的差分。前向一阶和二阶差分：

$$
\begin{aligned}
\Delta x[n]&=x[n+1]-x[n]\\
\Delta^2x[n]&=\Delta(\Delta x[n])\\
&=\Delta(x[n+1]-x[n])\\
&=x[n+2]-2x[n+1]+x[n]
\end{aligned}
$$

后向一阶和二阶差分：

$$
\begin{aligned}
\nabla x[n]&=x[n]-x[n-1]\\
\nabla^2x[n]&=\nabla(\nabla x[n])\\
&=\nabla(x[n]-x[n-1])\\
&=x[n]-2x[n-1]+x[n-2]
\end{aligned}
$$

### 奇异信号

就是存在不可微点的信号，比如单位斜变信号：

$$
r(t)=\begin{cases}
t&t\geq0\\
0&t\lt0
\end{cases}
$$

### 冲激信号

属于连续信号，其在零点处一个很小的领域内有非零值，且积分为1：

$$
\delta(t)=0,t\neq 0\\
\int_{-\infty}^\infty\delta(t)\mathrm dt=1
$$

![image-20211005170517626](/img/image-20211005170517626.png)

冲激信号可用于**表示其他任意信号**或**表示信号间断点的导数**.

> 冲激信号可以理解为连续信号中的单位脉冲信号，任何信号都可用冲激信号表示。

$$
\int_{-\infty}^\infty x(\tau)\delta(t-\tau)\mathrm d\tau=x(t)
$$

> 对于$\delta(at+b)$形式的冲激信号，要先利用冲激信号的**展缩特性**将其化为$\delta(t+b/a)/\vert a\vert$形式后，方可利用冲激信号的抽样特性与筛选特性。

### 信号的微积分

当做连续函数的微积分即可

<img src="/img/image-20211005171316852.png" alt="image-20211005171316852" style="zoom:50%;" />

<img src="/img/image-20211005171327682.png" alt="image-20211005171327682" style="zoom: 67%;" />

微分操作类似于”锐化“，积分操作相当于”模糊“。

## 系统的描述和卷积的引入

### 系统的分类与描述

#### 描述

用$N$阶微分（连续）或差分方程（离散）去表示输入输出；或者用状态空间去描述。方框图：

![image-20211006111717035](/img/image-20211006111717035.png)

系统可以串并联，以及反馈连接：

<img src="/img/image-20211006111823467.png" alt="image-20211006111823467" style="zoom:67%;" />

#### 分类

- 记忆系统和无记忆系统，无记忆系统：系统此时刻的输出只取决于系统**该时刻**的输入；
- 可逆系统和不可逆系统，可逆系统类比可逆函数，即系统在不同的输入下，导致不同的输出，则系统可逆；
- 因果系统和非因果系统，因果系统是当且仅当输入信号激励系统时才产生系统输出响应的系统，如果响应𝑦(𝑡)并不依赖于将来的激励，如𝑥(𝑡+1)，那么系统就是因果的；
- 稳定系统和不稳定系统，稳定系统指有界输入产生有界输出的系统，$y(t)=tx(t)$就是不稳定系统；
- 线性系统和非线性系统，如果一个输入信号是由几个**信号加权组成**的，则线性系统的输出是系统对这组信号中**每一个响应的加权和**（齐次性和可加性）；
- 时变系统和时不变系统，系统的输出响应与输入激励的关系不随输入激励作用于系统的时间起点而改变，就称为**时不变**系统。否则，就称为时变系统；

我们主要讨论线性时不变系统。线性时不变系统可由定**常系数**的**线性**微分方程或差分方程描述。

### 卷积

我们将讨论卷积运算从何而来，为什么会有

$$
x[n]*h[n]=\sum_{k=-\infty}^{+\infty}x[k]h[n-k]
$$

首先有信号的筛选性质，也就是对于离散信号，我们可以将其视作多个单一信号的和。比如下图左边的信号就可以分解为右图的多个信号：

![image-20211222155314995](/img/image-20211222155314995.png)

用公式表示就是

$$
x[n]=\sum_{k=-\infty}^{+\infty}x[k]\delta[n-k]
$$

那么在一个线性时不变(LTI)系统中，和信号的输出等于输出信号的和：

$$
y[n]=\sum_{k=-\infty}^{+\infty}x[k]h_k[n]
$$

将$\delta[n-k]$输入LTI系统，对应的相应是$h_k[n]$:

<img src="/img/image-20211222155710202.png" alt="image-20211222155710202" style="zoom: 67%;" />

利用时不变系统的性质

$$
h_{k}[n]=h_0[n-k]
$$

因此输出重写成

$$
y[n]=\sum_{k=-\infty}^{+\infty}x[k]h[n-k]
$$

上面的运算正是卷积和也就是说线性时不变系统的单位脉冲响应刻画了系统的特性。

将这样的概念拓展到连续信号，也就是卷积积分

![image-20211222160957398](/img/image-20211222160957398.png)

#### 卷积的性质

卷积满足交换律，加法分配率和结合率，我们不作证明。此外卷积满足平移特性：如果

$$
x_1(t)*x_2(t)=y(t)
$$

则

$$
\begin{aligned}
x_1(t-t_1)*x_2(t-t_2)
&=\int_{-\infty}^\infty x_1(\tau-t_1)x_2(t-\tau-t_2)\mathrm d\tau\\
&=\int_{-\infty}^\infty x_1(\tau)x_2(t-\tau-t_1-t_2)\mathrm d\tau\\
&=y(t-t_1-t_2)
\end{aligned}
$$

此外还有展缩特性

$$
\begin{aligned}
x_1(at)*x_2(at)
&=\int_{-\infty}^{+\infty}x_1(a\tau)x_2(a(t-\tau))\mathrm d\tau\\
&=\frac1{\vert a\vert}\int_{-\infty}^{+\infty}x_1(a\tau)x_2(at-a\tau)\mathrm da\tau\\
&=\frac1{\vert a\vert}y(at)
\end{aligned}
$$

此外，卷积积分还有微积分上的特性。微分特性：

$$
\begin{aligned}
\frac{\mathrm d}{\mathrm dt}[x_1(t)*x_2(t)]
&=\frac{\mathrm d}{\mathrm dt}\int_{-\infty}^{+\infty}x_1(\tau)x_2(t-\tau)\mathrm d\tau\\
&=\int_{-\infty}^\infty x_1(\tau)\frac{\mathrm d}{\mathrm dt}x_2(t-\tau)\mathrm d\tau\\
&=\int_{-\infty}^\infty x_1(\tau)x_2'(t-\tau)\mathrm d\tau\\
&=x_1(t)*x_2'(t)\\
&=x_1'(t)*x_2(t)&交换律\\
\end{aligned}
$$

积分特性：

$$
\begin{aligned}
\int_{-\infty}^{t}[x_1(\tau)*x_2(\tau)]\mathrm d\tau
&=\int_{-\infty}^t\int_{-\infty}^{+\infty}x_1(t')x_2(\tau-t')\mathrm dt'\mathrm d\tau\\
&=\int_{-\infty}^\infty x_1(t')\int_{-\infty}^{t}x_2(\tau-t')\mathrm d\tau\mathrm dt'\\
&=\int_{-\infty}^\infty x_1(t')(\int_{-\infty}^tx_2(\tau)\mathrm d\tau)\mathrm dt'\\
&=x_1(t)*\int_{-\infty}^tx_2(\tau)\mathrm d\tau\\
&=x_2(t)*\int_{-\infty}^tx_1(\tau)\mathrm d\tau&对称性\\
\end{aligned}
$$

上面讨论的是连续信号卷积积分的特性，而对于离散信号，其卷积和也满足交换律，加法分配率和结合率，以及平移特性。而对于微分特性和积分特性，只需要将微分改为差分，将积分改为求和即可。

### 使用卷积分析系统

将信号输入到一个系统，相当于将信号与系统的单位脉冲相应做卷积。因此对于级联系统的冲激相应

![image-20211222165035593](/img/image-20211222165035593.png)

有

$$
y(t)=z(t)*h_2(t)=x(t)*h_1(t)*h_2(t)=x(t)*(h_1(t)*h_2(t))
$$
所以我们可以将两级联系统看成一个：

![image-20211222165155705](/img/image-20211222165155705.png)

类似的，对于并联系统

![image-20211222165224490](/img/image-20211222165224490.png)

有

$$
\begin{aligned}
y(t)&=y_1(t)+y_2(t)\\
&=x(t)*h_1(t)+x(t)*h_2(t)\\
&=x(t)(h_1(t)+h_2(t))
\end{aligned}
$$

还是可以将两个级联信号看作一个：

![image-20211222165400456](/img/image-20211222165400456.png)

### 利用卷积判断系统的性质

因果连续时间LTI系统的冲激响应必须满足

$$
h(t)=0,t<0
$$

类似的，因果离散时间LTI系统的冲激响应必须满足

$$
h[n]=0,n<0
$$

通过计算系统的冲激响应，可以判断其是否为因果系统。

若系统对任意的有界输入其输出也有界，则称该系统是稳定系统。由此我们可以给出系统稳定的充要条件：连续时间LTI系统稳定的充分必要条件是

$$
\int_{-\infty}^\infty|h(\tau)|\mathrm d\tau<\infty
$$

类似的，离散时间LTI系统稳定的充分必要条件：

$$
\sum_{k=-\infty}^\infty|h[k]|<\infty
$$

我们可以对LTI特性与单位冲激响应的关系：

![image-20211222170456359](/img/image-20211222170456359.png)

### 卷积与相关

我们用“相关”运算来衡量信号间的相似程度

$$
x(t)\star h(t)=\int_{-\infty}^\infty x(\tau)h(\tau+t)d\tau=\int_{-\infty}^\infty x(\tau)h(\tau-t)d\tau
$$

注意到它和卷积运算十分相似，但也可以发现，相关运算不再满足交换律。相关运算和卷积运算有下面的关系：

$$
x(t)\star h(t)=x(-t)*h(t)
$$

## 微分方程、差分方程的求解

### 引入

系统数学模型的时域表示常常会用微分/差分方程描述。如果组成系统的原件都是参数恒定的线性元件，则相应的数学模型是一个**线性常系数常微分方程**。若此时系统中各元件起始无储能，则构成一个线性时不变系统。

下面是微分方程的一般形式：

$$
\frac{\mathrm d^N}{\mathrm dt^N}y(t)+a_{N-1}\frac{\mathrm d^{N-1}}{\mathrm dt^{N-1}}y(t)+\cdots a_1\frac{\mathrm d}{\mathrm dt}y(t)+a_0y(t)\\
=\frac{\mathrm d^M}{\mathrm dt^M}x(t)+b_{M-1}\frac{\mathrm d^{M-1}}{\mathrm dt^{M-1}}x(t)+\cdots b_1\frac{\mathrm d}{\mathrm dt}x(t)+b_0x(t)\tag{1}
$$

$a_i,b_i$都是常数；一般$N>M$。

后向差分方程（离散系统）：

$$
\sum_{i=0}^Na_iy[n-i]=\sum_{j=0}^Nb_jx[n-j]\tag{2}
$$

一个线性时不变（LTI）系统可以用常系数微分方程或常系数差分方程描述，但一个常系数微分方程或差分方程描述的系统不一定是线性时不变系统。

### 微分方程求解

我们考虑微分方程的求解，其完全解有**齐次解$y_h(t)$**和**特解$y_p(t)$**构成。齐次解就是输入有关的各项全部为0时方程的解，也就是(1)式右端为0。特解是方程的任意一个解。

#### 求齐次解

求齐次解，就是求下面的方程：

$$
\frac{\mathrm d^N}{\mathrm dt^N}y(t)+a_{N-1}\frac{\mathrm d^{N-1}}{\mathrm dt^{N-1}}y(t)+\cdots a_1\frac{\mathrm d}{\mathrm dt}y(t)+a_0y(t)=0\tag{3}
$$

齐次解为形如$Ae^{\alpha t}$函数的线性组合，代入有

$$
A\alpha^Ne^{\alpha t}+Aa_{N-1}\alpha^{N-1}e^{\alpha t}+\cdots+Aa_0e^{\alpha t}=0\tag{4}
$$

因此我们实际上求的是下面的$N$阶方程(特征方程)：

$$
\alpha^N+a_{N-1}\alpha^{N-1}+\cdots+a_0=0\tag{5}
$$

解出$N$个解(特征根)：$\alpha_1,\cdots,\alpha_N$。如果没有重根，那么齐次解为

$$
y_h(t)=\sum_{i=1}^NA_ie^{\alpha_it}\tag{6}
$$

$A_i$为待定系数。如果有共轭复根，$\alpha_1=m+jn,\alpha_2=m-jn$，则根据欧拉公式，我们有

$$
\begin{aligned}
y_h(t)&=A_1e^{\alpha_1t}+A_2e^{\alpha_2t}\\
&=e^{mt}((A_1+A_2)\cos nt+(A_1-A_2)\sin nt)
\end{aligned}\tag{7}
$$

现在考虑有重根的情况，假设$\alpha_1$为$k$阶重根，也就是原方程可以分解为

$$
(\alpha-\alpha_1)^k\prod_{i=2}^{N-k+1}(\alpha-\alpha_i)=0\tag{8}
$$

其齐次解为

$$
y_h(t)=(\sum_{i=1}^kA_it^{k-i})e^{\alpha_1t}+\sum_{i=2}^{N-k+1}A_ie^{\alpha_it}\tag{9}
$$

比如我们想求下面微分方程的齐次解

$$
y^{(3)}(t)+7y''(t)+16y'(t)+12y(t)=x(t)
$$

由上面的规则，先求特征方程

$$
\alpha^3+7\alpha^2+16\alpha+12=(\alpha+2)^2(\alpha+3)=0
$$

也就是一个二重根$\alpha_1=-2,\alpha_2=-3$，因此齐次解为

$$
y_h(t)=(A_1t+A_2)e^{-2t}+A_3e^{-3t}
$$

因为缺少初始条件，因此我们无法继续求出待定系数。

#### 求特解

现在考虑求特解，特解的形式和激励函数的形式有关，通过代入激励函数，观察形式，代入微分方程求解待定系数。下表可以为我们求特解提供参考：

<img src="/img/image-20211222190859027.png" alt="image-20211222190859027" style="zoom: 80%;" />

- 如果特解和齐次解重复，比如都是$e^{at}$，那么将特解设为$B_0te^{at}$；
- 若对应的特征根为二重根，齐次解为$te^{at}$，特解为$B_0t^2e^{at}$；
- 若特解为0时刻加入，则微分方程的解区间为$0_+\leq t<\infty$.

上面的描述或许有点抽象，我们来一个例子，给定微分方程

$$
y^{(2)}(t)+2y'(t)+3y(t)=x'(t)+x(t)
$$

设$x(t)=t^2$，求特解。

微分方程的右端是$t^2+2t$，参考上表，激励函数是$t^p$类型的，$p=2$，因此我们设特解形式为

$$
y_p(t)=B_1t^2+B_2t+B_3
$$

代入求解得到

$$
\begin{cases}
B_1=\frac13\\
B_2=\frac29\\
B_3=-\frac{10}{27}\\
\end{cases}
$$

因此特解为$y_p(t)=\frac13t^2+\frac29t-\frac{10}{27}$。

#### 求待定系数

现在考虑基于初始条件求待定系数，然后就可以得到完整的微分方程解。

例：微分方程

$$
y^{(2)}(t)+7y'(t)+6y(t)=6\sin(2t),t\geq0
$$

边界条件为$y(0)=0,y'(0)=0$，要求解这个方程。

三步走：求齐次解→求特解→求待定系数。先求齐次解：

$$
\alpha^2+7\alpha+6=(\alpha+1)(\alpha+6)=0
$$

因此齐次解为

$$
y_h(t)=A_1e^{-t}+A_2e^{-6t}
$$

再求特解，考虑输入为三角函数，故特解形式为

$$
y_p(t)=B_1\sin(2t)+B_2\cos(2t)
$$

代入得到特解

$$
y_p(t)=\frac3{50}\sin(2t)-\frac{21}{50}\cos(2t)
$$

因此微分方程的解：

$$
y(t)=y_h(t)+y_p(t)=A_1e^{-t}+A_2e^{-6t}+\frac3{50}\sin(2t)-\frac{21}{50}\cos(2t)
$$

考虑边界条件，得到方程组并求解

$$
\begin{cases}
A_1+A_2-\frac{21}{50}=0\\
-A_1-6A_2+\frac3{25}=0
\end{cases}\to\begin{cases}
A_1=\frac{12}{25}\\
A_2=-\frac3{50}
\end{cases}
$$

从而得到微分方程的解

$$
y(t)=\frac{12}{25}e^{-t}-\frac3{50}e^{-6t}+\frac3{50}\sin(2t)-\frac{21}{50}\cos(2t)
$$

### 差分方程求解

差分方程的齐次解就是下面方程的解

$$
\sum_{i=0}^Na_iy[n-i]=0
$$

齐次解为形如$C\alpha^n$函数的线性组合，令$y[n]=C\alpha^n$，则有特征方程

$$
a_0\alpha^N+a_1\alpha^{N-1}+\cdots+a_N=0
$$

解得$N$个特征根$\alpha_1,\cdots,\alpha_N$。

可以发现上述过程与微分方程的齐次解求解过程相似：

<img src="/img/image-20211222194827839.png" alt="image-20211222194827839" style="zoom:67%;" />

类似的，我们接下来考虑求特解，方法与求微分方程特解相似：

<img src="/img/image-20211222195039807.png" alt="image-20211222195039807" style="zoom:67%;" />

再来看一个例子：激励信号$x[n]=(\frac12)^nu[n],y[-1]=0,y[-2]=1,y[-3]=\frac12$，求差分方程

$$
y[n]+\frac13y[n-1]-\frac59y[n-2]+\frac19y[n-3]=x[n]-x[n-1]
$$

的完全相应。

仍是三步走：求齐次解→求特解→求待定系数。先求齐次解

$$
\alpha^3+\frac13\alpha^2-\frac59\alpha+\frac19=\frac19(3\alpha-1)^2(\alpha+1)
$$

也就是$\alpha_1=-1$，一个二重根$\alpha_2=\alpha_3=\frac13$，因此齐次解为

$$
y_h[n]=A_1(-1)^n+(A_2+A_3n)(\frac13)^n
$$

然后求特解，考虑激励信号的形式，查表，设特解为

$$
y_p[n]=C(\frac12)^n
$$

代入解得$C=-3$。因此特解为

$$
y_p[n]=-3(\frac12)^n
$$

所以差分方程的解

$$
y[n]=y_h[n]+y_p[n]=A_1(-1)^n+(A_2+A_3n)(\frac13)^n-3(\frac12)^n
$$

现在求待定系数，注意我们不能将原条件直接代入，因为在$n<0$时$y[n]$不满足上述方程，所以应求出$n=0,1,2$时系统的输出：

$$
\begin{cases}
y[0]+\frac13y[-1]-\frac59y[-2]+\frac19y[-3]=x[0]-x[-1]\\
y[1]+\frac13y[0]-\frac59y[-1]+\frac19y[-2]=x[1]-x[0]\\
y[2]+\frac13y[1]-\frac59y[0]+\frac19y[-1]=x[2]-x[1]\\
\end{cases}\to\begin{cases}
y[0]=\frac32\\
y[1]=-\frac{10}9\\
y[2]=\frac{103}{108}\\
\end{cases}
$$

再用这三个初始值来求出待定系数，得到最后的完全解：

$$
y[n]=\frac{35}{12}(-1)^n+(\frac{109}{32}+\frac{25}{24}n)(\frac13)^n-3(\frac12)^n,n\ge0
$$

## 系统分解和卷积的应用

### 系统响应的两种视角

我们在前面讨论了微分方程和差分方程的求解方法。现在讨论它们和系统间的联系。

微分方程的解可写成下面的形式

$$
y(t)=y_h(t)+y_p(t)
$$

也就是齐次解加上特解。回顾我们求齐次解的流程，会发现它的**形式**与输入的激励信号无关，但**参数**与激励信号有关。我们将齐次解称作“自由响应”，它反应系统的固有频率（本身的特性），而将特解称作强迫响应，因为它和激励函数的形式有关。

我们在求解方程的时候，需要用到解的初始条件以求解最终解的待定系数。常常是零时刻系统响应的各阶导数值。初始条件其实是系统本身具有的能量（储能），但随着激励信号的作用，信号及其导数可能会在零时刻发生跳变，也就是各阶导数在零点处的左极限和右极限不同。

当输入信号为0时，也就是是无外加激励信号，仅由系统的起始状态（起始时刻系统储能）单独作用而产生的响应，记为$y_{zi}(t)$，称作零输入响应。其求解的微分方程正是求齐次解时的齐次线性微分方程，其中的参数由初始条件决定。由于无输入，所以不需要考虑跳变，也就是各阶导数在零点处的左极限和右极限相同。**零输入响应是齐次解的一部分**：

$$
y_{zi}(t)=\sum_{k=1}^NA_{zik}e^{\alpha_kt}
$$

与之对应的是零状态响应：不考虑系统起始时刻储能的作用 （起始状态为0），由系统外加激励信号所产生的响应，记为$y_{zs}(t)$。它需要求解和原来一样的微分方程，但不同的是，因为是无储能的假设，因此零时刻的各阶导数都是0。**零状响应包含齐次解（的一部分）和特解**：

$$
y_{zs}(t)=\sum_{k=1}^NA_{zsk}e^{\alpha_kt}+B(t)
$$

实际上，上面对系统进行了两种分解：自由响应+强迫响应

$$
y(t)=y_h(t)+y_p(t)=\sum_{k=1}^NA_ke^{\alpha_kt}+B(t)
$$

零输入响应+零状态响应：

$$
\begin{aligned}
y(t)&=y_{zi}(t)+y_{zs}(t)\\
&=\sum_{k=1}^NA_{zik}e^{\alpha_kt}+\bigg(\sum_{k=1}^NA_{zsk}e^{\alpha_kt}+B(t)\bigg)
\end{aligned}
$$

我们来看一个例子：系统$y'(t)+3y(t)=3u(t)$，起始状态为$y(0_{-})=\frac32$，**无跳变**。

1. 求自由响应和强迫响应；

   求齐次解

   $$
   \alpha+3=0\\
   y_h(t)=A_1e^{-3t}
   $$

   激励信号是$u(t)$，因此特解就是1，所以解的形式为

   $$
   y(t)=A_1e^{-3t}+1
   $$

   因为没有跳变，信号值在零时刻的左极限和有极限相等：

   $$
   y(0_{-})=y(0_{+})=A_1+1=\frac32\to A_1=\frac12
   $$

   所以自由响应和强迫响应分别是

   $$
   y_h(t)=\frac12e^{-3t}\\
   y_p(t)=1
   $$

2. 求零输入响应和零状态响应.

   零输入响应，还是求特征方程得到齐次解，考虑初始条件，解出待定系数，得到零输入响应

   $$
   y_{zi}(t)=\frac32e^{-3t}
   $$

   零状态响应，基于初始值$y(0_{-})=0$的初始条件求$y(t)=A_1e^{-3t}+1$的待定系数，解得

   $$
   y_{zs}(t)=-e^{-3t}+1
   $$

### 利用卷积求解LTI系统的响应

零状态响应是由系统外加激励信号所产生的响应，系统初始无储能，那么系统就是时不变的，因此我们之前提到的卷积就可以派上用场了：

$$
y(t)=y_{zi}(t)+y_{zs}(t)=y_{zi}(t)+x(t)*h(t)
$$

所以我们可以通过求齐次微分方程得到零输入响应，而零状态响应可以利用卷积算出来。

例：系统的微分方程是

$$
y'(t)+3y(t)=2x(t)
$$

系统的冲激响应$h(t)=2e^{-3t}u(t)$，输入$x(t)=3u(t)$，求零状态响应：

$$
\begin{aligned}
y_{zs}(t)&=x(t)*h(t)\\
&=\int_{-\infty}^{+\infty}x(\tau)h(t-\tau)\mathrm d\tau\\
&=\int_{-\infty}^{+\infty}3u(\tau)2e^{-3(t-\tau)}u(t-\tau)\mathrm d\tau\\
&=\begin{cases}
6\int_0^t2e^{-3(t-\tau)}\mathrm d\tau&t>0\\
0&t<0
\end{cases}\\
&=\begin{cases}
2(1-e^{-3t})&t>0\\
0&t<0
\end{cases}\\
&=2(1-e^{-3t})u(t)
\end{aligned}
$$

### 冲激响应求解

某离散**因果**线性时不变系统的差分方程为

$$
y[n]+3[y-1]+2y[n-2]=x[n]
$$

现在要求冲激响应$h[n]$：因为是因果系统，所以用$y[0]=y[-1]=0$，由此代入得到初始条件$h[0]=1,h[1]=-3$。

如果要求冲激响应，那就是求差分方程

$$
y[n]+3[y-1]+2y[n-2]=\delta[n]
$$

解特征方程得到齐次解的形式为

$$
h[n]=C_1(-1)^n+C_2(-2)^n,n\ge0
$$

代入初始条件解出待定系数，得到冲激响应

$$
h[n]=[-1(-1)^n+2(-2)^n]u[n]
$$

## 傅里叶级数

### 三角傅里叶级数

傅里叶级数（三角形式）可以用来逼近一个周期信号：

$$
x(t)=a_0+\sum_{n=1}^\infty a_n\cos n\omega t+\sum_{n=1}^\infty b_n\sin n\omega t
$$

位置参数可以通过内积运算得出，直流分量：

$$
a_0=\dfrac{\left<x,1\right>}{\left<1,1\right>}=\frac1T\int_{t_0}^{t_0+T}x(t)\mathrm dt\\
$$

余弦分量：

$$
\begin{aligned}
a_n&=\dfrac{\left<x,\cos n\omega t\right>}{\left<\cos n\omega t,\cos\omega t\right>}\\
&=\dfrac{\int_{t_0}^{t_0+T}x(t)\cos n\omega t\mathrm dt}{\int_{t_0}^{t_0+T}\cos^2n\omega t\mathrm dt}\\
&=\dfrac{2}{T}\int_{t_0}^{t_0+T}x(t)\cos n\omega t\mathrm dt\\
&=a_{-n}
\end{aligned}
$$

正弦分量：

$$
\begin{aligned}
a_n&=\dfrac{\left<x,\sin n\omega t\right>}{\left<\sin n\omega t,\sin\omega t\right>}\\
&=\dfrac{\int_{t_0}^{t_0+T}x(t)\sin n\omega t\mathrm dt}{\int_{t_0}^{t_0+T}\sin^2n\omega t\mathrm dt}\\
&=\dfrac{2}{T}\int_{t_0}^{t_0+T}x(t)\sin n\omega t\mathrm dt\\
&=-b_{-n}
\end{aligned}
$$

利用辅助角公式，我们可以将傅里叶级数进一步简化：

$$
\begin{aligned}
x(t)&=a_0+\sum_{n=1}^\infty a_n\cos n\omega t+\sum_{n=1}^\infty b_n\sin n\omega t\\
&=c_0+\sum_{n=1}^\infty c_n\cos(n\omega t+\varphi_n)
\end{aligned}
$$

显然$c_0=a_0$仍是直流分量，而

$$
c_n\cos(n\omega t+\varphi_n)
$$

为**$n$次谐波分量**。上面的正弦，余弦包括谐波分量的频率都是基频$f=1/T$的整数倍。

#### 例子

假如我们想用傅里叶级数去逼近下面的函数：

![image-20211025162331319](/img/dsp/origin.png)

设为奇函数，基波周期为2，$(0,1)$区间内信号值为1；$(1,2)$区间内信号值为-1，我们可以按照上面的步骤去求相应的分量：

$$
\begin{aligned}
a_0&=0\\
a_n&=\int_0^2x(t)\cos n\pi t\mathrm dt\\
&=\int_0^1\cos n\pi t\mathrm dt-\int_1^2\cos n\pi t\mathrm dt\\
&=0\\
b_n&=\int_0^2x(t)\sin n\pi t\mathrm dt\\
&=2\int_0^1\sin n\pi t\mathrm dt\\
&=\dfrac{2-2\cos n\pi}{n\pi}
\end{aligned}
$$

也就是$n$为奇数时，正弦系数为$\frac{4}{n\pi}$，否则为0，用Python画出图像：

```python
import numpy as np
import matplotlib.pyplot as plt

def plot_fronier(N=10):
    x = np.linspace(-5, 5, 501)
    y = 0
    for n in range(1, N, 2):
        y += (4 / (n * np.pi)) * np.sin(n * np.pi * x)
    plt.plot(x, y, label="N={}".format(N))
    
plot_fronier(N=10)
plot_fronier(N=100)
plot_fronier(N=1000)
plt.legend()
plt.show()
```

输出时间-幅度图像：

<img src="/img/dsp/fronier.png" alt="1" style="zoom:67%;" />

可以发现，随着$N$的增大，傅里叶级数逐渐逼近原函数。而如果我们采用频域的视角，就可以画出频率-幅度图像（频谱）：

<img src="/img/dsp/freq-am.png" alt="2" style="zoom:50%;" />

### 指数傅里叶级数

周期信号$𝑥(𝑡)$可以分解为不同频率虚指数信号之和：

$$
x(t)=\sum_{n=-\infty}^\infty X_ne^{jn\omega t}
$$

相应的，我们可以求出分量$X_n$：

$$
\begin{aligned}
X_n&=\dfrac{\left<x,e^{jn\omega t}\right>}{\left<e^{jn\omega t},e^{jn\omega t}\right>}\\
&=\dfrac{\int_{t_0}^{t_0+T}x(t)e^{-jn\omega t}\mathrm dt}{\int_{t_0}^{t_0+T}e^{jn\omega t}e^{-jn\omega t}\mathrm dt}\\
&=\dfrac{1}T\int_{t_0}^{t_0+T}x(t)\cdot e^{-jn\omega t}\mathrm dt\\
&=\dfrac{1}T\int_{t_0}^{t_0+T}x(t)\cdot(\cos n\omega t-j\sin n\omega t)\mathrm dt\\
&=\frac12a_n-\frac{j}2b_n
\end{aligned}
$$

> 对于复数域，进行内积运算时，需要对后一项取共轭。

我们也不难将三角傅里叶和指数傅里叶的分量联系起来：

$$
\begin{aligned}
X_0&=c_0=a_0\\
X_{-n}&=\frac12a_n+\frac{j}2b_n\\
\vert X_n\vert&=\frac12\sqrt{a_n^2+b_n^2}\\
a_n&=X_n+X_{-n}\\
b_n&=j(X_n-X_{-n})\\
c_n&=\vert X_n\vert+\vert X_{-n}\vert\\
\end{aligned}
$$

#### 例子

还是以上面的函数为例，现在计算指数分量：

$$
\begin{aligned}
X_n&=\frac{1}{2}a_n-\frac{j}{2}b_n=-\frac{j(1-\cos n\pi)}{n\pi}\\
X_{-n}&=\frac{1}{2}a_n+\frac{j}{2}b_n=\frac{j(1-\cos n\pi)}{n\pi}
\end{aligned}
$$

其对应的频谱是双边的（从$-\infty$求和到$+\infty$），对应的，其包络线是三角频谱高度的一半，但负频率是计算的结果，没有实际物理意义。

## 傅里叶变换

### 推导

对于一个周期信号$x(t)$，当其周期$T\to\infty$时，信号便近似于一个非周期信号。与此同时，考虑信号频谱图：对于周期信号，由傅里叶级数的分解结果知，频谱函数的定义域为$\\{n\omega\vert n\in\mathbb Z\\}$，当$T\to\infty,\omega\to0$，那么频谱的定义域也会趋于连续。

我们开始推导傅里叶变换：在指数傅里叶级数中，各分量为

$$
X_n=\dfrac1T\int_{t_0}^{t_0+T}x(t) e^{-jn\omega t}\mathrm dt
$$

其实可以写成函数的形式：

$$
X(nj\omega)=\dfrac1T\int_{-\frac T2}^{\frac T2}x(t)e^{-jn\omega t}\mathrm dt
$$

定义频谱密度函数

$$
\begin{aligned}
X(j\omega)
&=\lim_{T\to\infty}X(nj\omega)T\\
&=\lim_{\omega\to0}\dfrac{X(nj\omega)2\pi}{\omega}\\
&=\lim_{T\to\infty}\int_{-\frac T2}^{\frac T2}x(t)e^{-jn\omega t}\mathrm dt\\
&=\int_{-\infty}^\infty x(t)e^{-j\omega t}\mathrm dt\\
\end{aligned}
$$

从$x(t)$到$X(j\omega)$的过程为**傅里叶变换**，记作$X(j\omega)=\mathcal{F}[x(t)]$，我们也可以进行逆变换，我们有：

$$
\begin{aligned}
x(t)&=\sum_{n=-\infty}^\infty X(nj\omega)e^{jn\omega t}\\
&=\sum_{n=-\infty}^\infty\dfrac{X(nj\omega)}{\omega}e^{jn\omega t}\cdot\omega\\
&=\dfrac{1}{2\pi}\sum_{n=-\infty}^\infty\dfrac{X(nj\omega)2\pi}{\omega}e^{jn\omega t}\cdot\omega\\
\lim_{\omega} x(t)&=\dfrac 1{2\pi}\int_{-\infty}^\infty X(j\omega)e^{jn\omega t}\mathrm d\omega
\end{aligned}
$$

该过程称作傅里叶逆变换，记作

$$
x(t)=\mathcal{F}^{-1}[X(j\omega)]=\dfrac 1{2\pi}\int_{-\infty}^\infty X(j\omega)e^{jn\omega t}\mathrm d\omega
$$

其中$X(j\omega)$通常是复函数：

$$
X(j\omega)=\vert X(j\omega)\vert e^{j\varphi(\omega)}
$$

称$\omega-\vert X(j\omega)\vert$曲线是幅度频谱，$\omega-e^{j\varphi(\omega)}$曲线为相位频谱。

### 例子

<img src="/img/dsp/ex.png" alt="ex" style="zoom:67%;" />

用傅里叶变换：

$$
\begin{aligned}
X(j\omega)&=\int_{-\infty}^\infty x(t) e^{-jn\omega t}\mathrm dt\\
&=\int_{-\frac{\tau}{2}}^{\frac{\tau}2} Ae^{-jn\omega t}\mathrm dt\\
&=A\int_{-\frac{\tau}{2}}^{\frac{\tau}2}(\cos n\omega t-j\sin n\omega t)\mathrm dt\\
&=2A\int_{0}^{\frac{\tau}2}\cos n\omega t\mathrm dt\\
&=\frac{2A}{n\omega}\sin\frac{n\omega\tau}{2}
\end{aligned}
$$

所以**幅度谱**：

$$
\vert X(j\omega)\vert=\dfrac{2A}{n\omega}\vert\sin\frac{n\omega\tau}{2}\vert
$$

求**相位谱**：

$$
\begin{aligned}
e^{j\varphi(\omega)}&=\text{sgn}(\sin\dfrac{n\omega\tau}{2})\\
&=\cos\varphi(\omega)+j\sin\varphi(\omega)
\end{aligned}
$$

所以有

$$
\varphi(\omega)=\begin{cases}
0&\frac{4n\pi}{\tau}\lt\vert\omega\vert\lt\frac{(4n+2)\pi}{\tau}\\
\pi&\frac{(4n+2)\pi}{\tau}\lt\vert\omega\vert\lt\frac{(4n+4)\pi}{\tau}\\
\end{cases}
$$

频谱图：

<img src="/img/dsp/freq.png" alt="2" style="zoom:50%;" />

### 周期信号下的傅里叶变换

已知

$$
\mathcal{F}[1]=2\pi\delta(\omega)
$$

由频移特性

$$
\mathcal{F}[e^{j\omega_0t}]=2\pi\delta(\omega-\omega_0)\\\mathcal{F}[e^{-j\omega_0t}]=2\pi\delta(\omega+\omega_0)\\
$$

合并，从而得到典型周期信号的傅里叶级数

$$
\begin{aligned}
\mathcal{F}[\cos(\omega_0t)]
&=\mathcal{F}[\frac12 e^{j\omega_0t}+\frac12e^{-j\omega_0t}]\\
&=\pi\delta(\omega-\omega_0)+\pi\delta(\omega+\omega_0)\\
\mathcal{F}[\sin(\omega_0t)]
&=\mathcal{F}[\frac1{2j}\big(e^{j\omega_0t}-e^{-j\omega_0t}\big)]\\
&=j\pi\delta(\omega+\omega_0)-j\pi\delta(\omega-\omega_0)\\
\end{aligned}
$$

一般周期信号的傅里叶级数：

$$
x(t)=\sum_{n=-\infty}^\infty X_ne^{jn\omega_0 t}
$$

其中$x(t)$的周期是$T_0$，角频率就是$\omega_0=\frac{2\pi}{T_0}$，两边同时取傅里叶变换：

$$
\begin{aligned}
\mathcal{F}[x(t)]&=\mathcal F[{\sum_{n=-\infty}^\infty X_ne^{jn\omega t}}]\\
&=\sum_{n=-\infty}^\infty X_n\mathcal{F}[e^{jn\omega t}]\\
&=2\pi\sum_{n=-\infty}^\infty X_n\delta(\omega-n\omega_0)
\end{aligned}
$$

其中

$$
X_n=\dfrac1{T_0}\int_{t_0}^{t_0+T}x(t)e^{-nj\omega_0t}\mathrm dt
$$

周期信号傅里叶级数和傅里叶变换的关系：周期脉冲序列的傅里叶级数等于单位脉冲傅里叶变换系数在$n\omega_0$点处取值乘$\frac{1}{T_0}$。

### 性质以及证明

对于任意连续信号$x(t)$，其傅里叶变换

$$
X(j\omega)=\mathcal{F}[x(t)]=\int_{-\infty}^{+\infty}x(t)e^{-j\omega t}\mathrm dt
$$

我们在这里对其多种性质进行列举和推导:

#### 线性性质

多个信号线性组合的傅里叶变换等于傅里叶变换的线性组合:

$$
\begin{aligned}
\mathcal{F}[ax_1(t)+bx_2(t)]
&=\int_{-\infty}^{+\infty}(ax_1(t)+bx_2(t))e^{-j\omega t}\mathrm dt\\
&=\int_{-\infty}^{+\infty}ax_1(t)e^{-j\omega t}\mathrm dt+\int_{-\infty}^{+\infty}bx_2(t)e^{-j\omega t}\mathrm dt\\
&=a X_1(j\omega)+bX_2(j\omega)
\end{aligned}
$$

#### 对称性

如果$\mathcal{F}[x(t)]=X(j\omega)$，那么我们有$\mathcal{F}[X(t)]=2\pi x(-j\omega)$. 证明:

$$
\begin{aligned}
x(t)&=\frac1{2\pi}\int_{-\infty}^{+\infty}X(j\omega)e^{j\omega t}\mathrm d\omega\\
x(-t)&=\frac1{2\pi}\int_{-\infty}^{+\infty}X(j\omega)e^{-j\omega t}\mathrm d\omega\\
将t和\omega互换:\\
x(-j\omega)&=\frac1{2\pi}\int_{-\infty}^{+\infty}(t)e^{-j\omega t}\mathrm dt\\
&=\frac{1}{2\pi}\mathcal{F}[X(t)]
\end{aligned}
$$

如果$x(t)$是偶信号，则有

$$
\mathcal{F}[X(t)]=2\pi x(j\omega)
$$

#### 展缩特性

我们考察展缩后的时域信号在傅里叶变换后的频域信号:

$$
\begin{aligned}
\mathcal{F}[x(at)]
&=\int_{-\infty}^{+\infty}x(at)e^{-j\omega t}\mathrm dt\\
&=\frac{1}{\vert a\vert}\int_{-\infty}^{+\infty}x(at)e^{-\frac{j\omega}{a}\cdot a t}\mathrm d(at)\\
&=\frac1{\vert a\vert}X(j\frac{\omega}{a})
\end{aligned}
$$

也就是，时域压缩则频域拉伸，反之亦然.

#### 时移特性

考察时移后的时域信号在傅里叶变换后的频域信号:

$$
\begin{aligned}
\mathcal{F}[x(t-t_0)]
&=\int_{-\infty}^{+\infty}x(t-t_0)e^{-j\omega t}\mathrm dt\\
&=\int_{-\infty}^{+\infty}x(t-t_0)e^{-j\omega(t-t_0)}e^{-j\omega t_0}\mathrm dt\\
&=e^{-j\omega t_0}\int_{-\infty}^{+\infty}x(t-t_0)e^{-j\omega(t-t_0)}\mathrm d(t-t_0)\\
&=e^{-j\omega t_0}X(j\omega)
\end{aligned}
$$

#### 频移特性

类似的，考察平移后的频域信号在傅里叶逆变换后的表现:


$$
\begin{aligned}
\mathcal{F}^{-1}[X(j(\omega-\omega_0))]
&=\frac{1}{2\pi}\int_{-\infty}^{+\infty}X(j(\omega-\omega_0))e^{j\omega t}\mathrm d\omega\\
&=\frac{1}{2\pi}\int_{-\infty}^{+\infty}X(j(\omega-\omega_0))e^{j(\omega-\omega_0)t}e^{j\omega_0t}\mathrm d\omega\\
&={e^{j\omega_0t}}x(t)\\
\end{aligned}
$$

#### 时域卷积特性

对于傅里叶变换，我们有：时域的卷积等于频域的乘积. 证明：

$$
\begin{aligned}
\mathcal{F}[x_1(t)*x_2(t)]
&=\mathcal{F}[\int_{-\infty}^{+\infty}x_1(\tau)x_2(t-\tau )\mathrm d\tau]\\
&=\int_{-\infty}^{+\infty}\bigg(\int_{-\infty}^{+\infty}x_1(\tau)x_2(t-\tau )\mathrm d\tau\bigg)e^{-j\omega t}\mathrm dt\\
&=\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}x_1(\tau)x_2(t-\tau)e^{-j\omega t}\mathrm dt\mathrm d\tau\\
&=\int_{-\infty}^{+\infty}x_1(\tau)\int_{-\infty}^{+\infty}x_2(t-\tau)e^{-j\omega t}\mathrm dt\mathrm d\tau\\
&=\int_{-\infty}^{+\infty}x_1(\tau)X_2(j\omega)e^{-j\omega\tau}\mathrm d\tau\\
&=X_2(j\omega)\int_{-\infty}^{+\infty}x_1(\tau)e^{-j\omega\tau}\mathrm d\tau\\
&=X_1(j\omega)X_2(j\omega)
\end{aligned}
$$

#### 频域卷积特性

对于傅里叶变换，我们还有：频域的卷积**正比于**时域的乘积. 证明：

$$
\begin{aligned}
\mathcal{F}^{-1}[X_1(j\omega)*X_2(j\omega)]
&=\frac{1}{2\pi}\int_{-\infty}^{+\infty}X_1(j\omega)*X_2(j\omega)\cdot e^{j\omega t}\mathrm d\omega\\
&=\frac{1}{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}X_1(j\omega_0)X_2(j(\omega-\omega_0))\mathrm d \omega_0\cdot e^{j\omega t}\mathrm d\omega\\
&=\frac1{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}X_1(j\omega_0)X_2(j(\omega-\omega_0))e^{j\omega t}\mathrm d\omega_0\mathrm d\omega\\
&=\int_{-\infty}^{+\infty}X_1(j\omega_0)\bigg(\frac1{2\pi}\int_{-\infty}^{+\infty}X_2(j(\omega-\omega_0))e^{j\omega t}\mathrm d\omega\bigg)\mathrm d\omega_0\\
&=\int_{-\infty}^{+\infty}X_1(j\omega_0)x_2(t)e^{j\omega_0t}\mathrm d\omega_0\\
&=x_2(t)\int_{-\infty}^{+\infty}X_1(j\omega_0)e^{j\omega_0t}\mathrm d\omega_0\\
&=2\pi\;x_1(t)x_2(t)
\end{aligned}
$$

**注意到频域卷积和时域乘积之间有一个比例系数**$2\pi$.

#### 时域微分特性

我们考虑时域信号对时间微分后的傅里叶变换:

$$
\begin{aligned}
x(t)
&=\frac1{2\pi}\int_{-\infty}^{+\infty}X(j\omega)e^{j\omega t}\mathrm d\omega\\
\dfrac{\mathrm dx(t)}{\mathrm dt}
&=\dfrac{\mathrm d}{\mathrm dt}\frac1{2\pi}\int_{-\infty}^{+\infty}X(j\omega)e^{j\omega t}\mathrm d\omega\\
&=\frac1{2\pi}\int_{-\infty}^{+\infty}X(j\omega)\frac{\mathrm de^{j\omega t}}{\mathrm dt}\mathrm d\omega\\
&=\frac1{2\pi}\int_{-\infty}^\infty j\omega X(j\omega)e^{j\omega t}\mathrm d\omega\\
&=\mathcal{F}[j\omega X(j\omega)]\\
\mathcal{F}[\dfrac{\mathrm dx(t)}{\mathrm dt}]&=j\omega X(j\omega)
\end{aligned}
$$

我们可以进一步推导出$n$阶微分下的傅里叶变换:

$$
\begin{aligned}
\dfrac{\mathrm d^nx(t)}{\mathrm dt^n}
&=\frac{1}{2\pi}\int_{-\infty}^{+\infty}X(j\omega)\frac{\mathrm d^ne^{j\omega t}}{\mathrm dt^n}\mathrm d\omega\\
&=\mathcal{F}[(j\omega)^nX(j\omega)]\\
\mathcal{F}[\dfrac{\mathrm d^nx(t)}{\mathrm dt^n}]&=(j\omega)^nX(j\omega)
\end{aligned}
$$

#### 频域微分特性

类似的，我们也可以考虑频域信号对频率微分下的傅里叶变换:

$$
\begin{aligned}
X(j\omega)&=\int_{-\infty}^{+\infty}x(t)e^{-j\omega t}\mathrm dt\\
\dfrac{\mathrm d^nX(j\omega)}{\mathrm d\omega^n}&=\int_{-\infty}^{+\infty}x(t)\frac{\mathrm de^{-j\omega t}}{\mathrm d\omega}\mathrm dt\\
&=\mathcal{F}[(-jt)^n x(t)]\\
&=(-j)^n\mathcal{F}[t^n x(t)]\\
j^n\dfrac{\mathrm d^nX(j\omega)}{\mathrm d\omega^n}&=\mathcal{F}[t^n x(t)]
\end{aligned}
$$

## 信号的抽样

### 时域采样

我们考虑用脉冲序列：

$$
\delta_{T_s}(t)=\sum_{n=-\infty}^\infty\delta(t-nT_s)
$$

与连续信号相乘，从而对信号进行采样：

$$
x_s(t)=x(t)\cdot\delta_{T_s}(t)=\sum_{n=-\infty}^\infty x(nT_s)\delta(t-nT_s)
$$

图示：

![image-20211223213849307](/img/image-20211223213849307.png)

现在对采样信号进行频域分析，也就是傅里叶变换。先看脉冲序列的傅里叶变换，因为是周期连续信号，因此先求傅里叶级数，再逐项进行傅里叶变换：

$$
\begin{aligned}
\delta_{T_s}(t)
&=\sum_{n=-\infty}^\infty X_ne^{jn\omega_st}\\
&=\sum_{n=-\infty}^\infty\bigg(\frac1{T_s}\int_{-\frac{T_s}2}^{\frac {T_s}2}\delta(t)e^{-jn\omega_st}\mathrm dt\bigg)e^{jn\omega_st}\\
&=\sum_{n=-\infty}^\infty\frac1{T_s}e^{jn\omega_st}\\
\mathcal{F}[\delta_{T_s}(t)]
&=\sum_{n=-\infty}^\infty\frac1{T_s}\mathcal{F}[e^{jn\omega_st}]\\
&=\frac1{T_s}\sum_{n=-\infty}^\infty2\pi\delta(\omega-n\omega_s)\\
&=\omega_s\sum_{n=-\infty}^\infty\delta(\omega-n\omega_s)\\
\end{aligned}
$$

所以由频域卷积得到

$$
\begin{aligned}
\mathcal{F}[x(t)\cdot\delta_{T_s}(t)]
&=\frac1{2\pi}X(j\omega)*\omega_s\sum_{n=-\infty}^\infty\delta(\omega-n\omega_s)\\
&=\frac1{2\pi}\sum_{n=-\infty}^\infty X(j\omega)*\omega_s\delta(\omega-n\omega_s)\\
&=\frac{\omega_s}{2\pi}\sum_{n=-\infty}^\infty X(j(\omega-n\omega_s))\\
&=\frac1{T_s}\sum_{n=-\infty}^\infty X(j(\omega-n\omega_s))\\
\end{aligned}
$$

也就是说，冲激信号的离散化导致原信号的单一频谱在频域上重复（周期延拓），时域的离散化导致了频域的周期性：

![image-20211223215544957](/img/image-20211223215544957.png)

上述的冲激序列是理想情况，真实情况下都是用周期矩形信号

![image-20211223215627556](/img/image-20211223215627556.png)

来近似冲激序列。我们考虑这种情况下采样信号的傅里叶变换：

$$
\begin{aligned}
\mathcal{F}[x_s(t)]&=\sum_{n=-\infty}^\infty P_nX(j(\omega-n\omega_s))\\
P_n&=\frac{E\tau}{T_s}Sa(\frac{n\omega_s\tau}2)
\end{aligned}
$$

$P_n$不再和之前的$X_n$那样是常数，导致原频谱的周期延拓不再是完全的复制：

![image-20211223220401071](/img/image-20211223220401071.png)

### 频域采样

我们现在反过来考虑对信号的频域进行采样，也就是用频域的脉冲序列

$$
\delta_{\omega_s}(\omega)=\sum_{n=-\infty}^\infty\delta(\omega-n\omega_s)
$$

设$\mathcal{F}[x(t)]=X(j\omega)$，对其采样得到$X_s(j\omega)$：

$$
X_s(j\omega)=X(j\omega)\cdot\delta_{\omega_s}(\omega)
$$

先考虑脉冲序列的傅里叶逆变换：

$$
\begin{aligned}
\mathcal{F}[\delta_{T_s}(t)]=\omega_s\delta_{\omega_s}(\omega)\\
\mathcal{F}^{-1}[\delta_{\omega_s}(\omega)]=\frac1{\omega_s}\delta_{T_s}(t)
\end{aligned}
$$

再由时域卷积等于频域乘积，我们有

$$
\begin{aligned}
\mathcal{F}^{-1}[X_s(j\omega)]&=\mathcal{F}^{-1}[X(j\omega)\cdot\delta_{\omega_s}(\omega)]\\
&=x(t)*\frac1{\omega_s}\delta_{T_s}(t)\\
&=\frac1{\omega_s}\sum_{n=-\infty}^\infty x(t-nT_s)
\end{aligned}
$$

也就是说，**频域的离散化对应时域信号的周期延拓**。因此，一个域的离散化和另一个域的周期性相对应，反之，一个域的连续性与另一个域的非周期性相对应。

### 采样定理

采样定理：若连续信号$x(t)$是一个**频带受限**信号（若$\vert{\omega}\vert>\omega_m$则$X(j\omega)=0$，$\omega_m=2\pi f_m$），$x(t)$的等间隔样本值$x_s(t)$，用它唯一表示$x(t)$的条件是

$$
T_s<\frac1{2f_m}\leftrightarrow\omega_s>2\omega_m
$$

条件：

1. 等间隔采样，频带受限；
2. 唯一恢复条件（采样频率）；
3. 恢复方法（低通滤波器）.

## 信号的调制与解调

### 信号调制

高频信号具有传播距离远等优点，因此当我们传输低频信号时，考虑将它嵌入到一个高频振荡信号上，这一过程称作“调制”，而当我们接受这一混合信号时，需要有办法将我们需要的低频信号抽取出来，这一过程称作“解调”。

待发送的信号$x(t)$为**调制信号**，用于完成载送信号任务的高频振荡信号$c(t)$为**载波信号**，调制后的高频信号成为**已调波**。

我们考虑用正弦信号作为载波进行调幅，示意图如下：

![image-20211223230957979](/img/image-20211223230957979.png)

设载波$c(t)=\cos(\omega_ct)$，考虑合成信号

$$
y(t)=x(t)\cdot c(t)=x(t)\cdot\cos(\omega_ct)
$$

的傅里叶变换：

$$
\begin{aligned}
\mathcal{F}[y(t)]
&=\mathcal{F}[x(t)\cdot\cos(\omega_ct)]\\
&=\frac1{2\pi}X(j\omega)*\mathcal{F}[\cos(\omega_ct)]\\
&=\frac1{2\pi}X(j\omega)*\pi[\delta(\omega+\omega_c)+\delta(\omega-\omega_c])\\
&=\frac12[X(j(\omega+\omega_c))+X(j(\omega-\omega_c)]
\end{aligned}
$$

也就是说，载波的加入使得原信号的频谱分别向频域两边移动：

![image-20211223231548907](/img/image-20211223231548907.png)

只要$\omega_c>\omega_m$，两个频谱就不会发生重叠。

受上面的启发，我们考虑复指数信号作为载波信号：设$c(t)=e^{j(\omega_ct+\varphi)},\varphi=0$进行调幅，那么有

$$
Y(j\omega)=\frac1{2\pi}[X(j\omega*2\pi\delta(\omega-\omega_c))]=X(j(\omega-\omega_c))
$$

也就是直接将频谱进行移动：

![image-20211223231836198](/img/image-20211223231836198.png)

不再要求$\omega_c>\omega_m$。

### 单边带调幅

如果只发送上边带或者下边带信号，就可以节省能量和带宽。我们采用带通滤波器实现单边带幅度调制：

![image-20211223232032650](/img/image-20211223232032650.png)

这样在频域左半轴得到上边带，右半轴得到下边带：

![image-20211223232132105](/img/image-20211223232132105.png)

### 同步解调

我们想从以正弦信号为载波的合成信号中复原出调制信号，只需要再乘一个$c(t)$即可：

$$
\begin{aligned}
r(t)&=y(t)\cos(\omega_ct)\\
&=x(t)\cos^2(\omega_ct)\\
&=\frac12x(t)(1+\cos2\omega_ct)\\
R(j\omega)&=\frac12X(j\omega)+\frac14[X(j(\omega+2\omega_c))+X(j(\omega-2\omega_c))]
\end{aligned}
$$

这样，我们将频谱移回到远处，仅有$\frac12$系数差别：

![image-20211223232625506](/img/image-20211223232625506.png)

而对于前面提到的单边带调幅，对应的解调方法也是乘以载波信号，调制信号的傅里叶变换：

$$
X_0(j\omega)=\frac12\{Y_{dn}[j(\omega+\omega_c)]+Y_{dn}[j(\omega-\omega_c)]\}
$$

恰好也能形成$X(j\omega)$，相差系数$\frac14$：

![image-20211223233414156](/img/image-20211223233414156.png)

### 系统频谱分析

我们考虑下面的系统

![image-20211223233843961](/img/image-20211223233843961.png)

输入信号的频谱已知。分析A、B、C、D各点以及输出的频谱，求出$y(t)$与$x(t)$的关系。

我们从左开始分析，输入信号在$A$端正弦信号载波影响下，频谱分别左右移动$100$，同时幅度减半；通过带通滤波器，$\vert\omega_m\vert=100$，导致其外的部分被删除，因此C点的频谱：

![image-20211223234323241](/img/image-20211223234323241.png)

再次用相同的载波信号调制，再把上面的频谱分别左移右移100，得到D点

![image-20211223234523771](/img/image-20211223234523771.png)

通过带通滤波器，得到中间的部分，显然

$$
Y(j\omega)=\frac14X(j\omega)\\
y(t)=\frac14x(t)
$$

## 离散信号的傅里叶分析

回顾前面讨论的傅里叶级数与变换。针对连续周期信号，我们有傅里叶级数(FS)：

$$
x(t)=\sum_{n=-\infty}^\infty X_ne^{jn\omega t}\\
X_n=\frac1{T_1}\int_{t_0}^{t_0+T}x(t)\cdot e^{-jn\omega t}\mathrm dt
$$

形成的是离散的频谱。傅里叶变换(FT)：

$$
\begin{aligned}
\mathcal{F}[x(t)]&=\int_{-\infty}^\infty x(t)e^{-j\omega t}\mathrm dt\\
\mathcal{F}^{-1}[X(j\omega)]&=\frac1{2\pi}\int_{-\infty}^\infty X(s)e^{j\omega t}\mathrm d\omega
\end{aligned}
$$

形成的是连续频谱。本文讨论离散信号的傅里叶变换。

### 离散时间傅里叶变换

我们引入离散时间傅里叶变换(DTFT):

$$
\begin{aligned}
\text{DTFT}[x[n]]&=X(e^{j\omega})\\
&=\sum_{n=-\infty}^\infty x[n]e^{-jn\omega}\\
\text{IDTFT}[X(e^{j\omega})]&=\frac1{2\pi}\int_{-\pi}^\pi X(e^{j\omega})e^{jn\omega}\mathrm d\omega
\end{aligned}
$$

离散时间傅里叶正变换就是将对$t$积分改为对$n$求和。因为$\omega$是连续的，因此逆变换还是积分而不是求和。$X(e^{j\omega})$是复数，是以$2\pi$为周期的**周期函数**，这一点在采样那一部分就提及了。

比如我们想算$x[n]=u[n]-u[n-5]$的离散时间傅里叶变换：

$$
\begin{aligned}
\text{DTFT}[x[n]]&=\sum_{n=-\infty}^\infty x[n]e^{-jn\omega}\\
&=\sum_{n=0}^5e^{-jn\omega}\\
&=\frac{1-e^{-j5\omega}}{1-e^{-j\omega}}
\end{aligned}
$$

类似傅里叶变换，离散时间傅里叶变换也有类似的性质：

- 时移；
- 频移；
- 时域卷积；
- 频域卷积；
- 频域微分.

### 离散傅里叶级数

在连续信号的傅里叶级数中，每一项$e^{jn\omega t}$都可以看作是组成该信号的一个基。显然连续信号中，基的数量是无穷的。而对于周期离散信号，由于其频谱是周期性的，因此我们可以用有限的基对信号进行表达。

$$
e^{jk\omega n}=e^{jk\frac{2\pi}Nn}
$$

这样的基一共有N个，称作离散正交基。可以发现上面的离散正交基即使关于$n$的周期函数，也是关于$k$的周期函数，周期都是$N$，分别代表时域和频域的周期性。

对于周期为$N$的序列$\tilde{x}[n]$可分解为基本序列$e^{j\frac{2\pi}Nnk}$的和。因为频域和时域都是周期性的，所以都只需要用一个周期的信息表示：

$$
\begin{aligned}
\tilde{X}[k]&=\text{DFS}(\tilde{x}[n])=\sum_{n=0}^{N-1}\tilde{x}[n]W_N^{kn}\\
\tilde{x}[n]&=\text{IDFS}(\tilde{X}[k])=\frac1N\sum_{k=0}^{N-1}\tilde{x}[k]W_N^{-kn}
\end{aligned}
$$

其中$W_N=e^{-j\frac{2\pi}N}$。

举个例子，周期单位脉冲序列$\delta_N[n]$的离散傅里叶级数：

$$
\tilde{X}[k]=\sum_{n=0}^{N-1}\delta_N[n]e^{-j\frac{2\pi}Nnk}=1
$$

#### 四种变换的关系

考虑我们已经提及的四种变换：

1. 傅里叶级数：时域连续周期信号→频域离散非周期信号；
2. 傅里叶变换：时域连续非周期信号→频域连续非周期信号；
3. 离散时间傅里叶变换：时域离散非周期信号→频域连续周期$(2\pi)$信号；
4. 离散傅里叶级数：时域离散周期信号→频域离散周期$(N)$信号。

### 离散傅里叶变换

由于计算机系统是离散的，而现实中大部分信号都是非周期的，我们想要一种变换，输入是非周期离散信号，输出是离散信号。但观察上面的四种变换，无一符合条件，最接近的是离散傅里叶级数。因此我们提出**离散傅里叶变换**，针对一个有穷离散输入，当做是一个周期序列进行处理，我们称这样长度为$N$的输入为**主值序列**。

$$
\begin{aligned}
X[k]&=\sum_{n=0}^{N-1}x[n]e^{-j\frac{2\pi}Nnk}=\sum_{n=0}^{N-1}x[n]W_N^{nk},k=0,1,\cdots,N-1\\
x[n]&=\frac1N\sum_{k=0}^{N-1}X[k]e^{j\frac{2\pi}Nnk}=\frac1N\sum_{k=0}^{N-1}X[k]W_{N}^{nk},n=0,1,\cdots,N-1
\end{aligned}
$$

表示为

$$
X[k]=\text{DFT}\{x[n]\},x[n]=\text{IDFT}\{X[k]\}
$$

对于上述的求和，我们可以用矩阵表示DFT，设

$$
\begin{aligned}
\pmb {X}&=\begin{bmatrix}
X[0]&X[1]&\cdots&X[N-1]
\end{bmatrix}^T\\
\pmb {x}&=\begin{bmatrix}
x[0]&x[1]&\cdots&x[N-1]
\end{bmatrix}^T
\end{aligned}
$$

则DFT可以表示为

$$
\pmb X=\begin{bmatrix}
1&1&1&1&1\\
1&W_N^1&W_N^2&\cdots&W_N^{N-1}\\
1&W_N^2&W_N^4&\cdots&W_N^{2(N-1)}\\
\vdots&\vdots&\vdots&\ddots&\vdots\\
1&W_{N}^{N-1}&W_{N}^{2(N-1)}&\cdots&W_{N}^{(N-1)\times(N-1)}&
\end{bmatrix}\pmb x
$$

DFT、DFS和DTFT的关系：显然DFT是截取了DFS的主值序列构成的变换对，DFT也是DTFT $X(e^{j\omega})$在一个周期的等间隔抽样。

#### 离散傅里叶变换的性质

线性性：需将较短序列补零后，再按长序列的点数做DFT，才能满足线性性；

循环位移特性：$y[n]=x[(n\pm m)_N]R_N[n]$；

$$
\text{DFT}\{x(n+m)_N]\}
$$

时域的循环位移对应频域的相移：

$$
\text{DFT}\{x[(n+m)_N]\}=W_N^{-mk}X[k]\\
\text{DFT}\{x[(n-m)_N]\}=W_N^{mk}X[k]\\
$$

这里可以将公式与傅里叶变换进行类比：

$$
\mathcal{F}[x(t-t_0)]=e^{-j\omega t_0}X(j\omega)
$$

因为$W_N=e^{-j\frac{2\pi}N}$，因此符号有差别。相对应的，时域的相移对应频域的循环位移:

$$
\text{DFT}\{W_N^{ln}x[n]\}=X[(k+l)_N]
$$

##### 循环卷积

这里引入序列的循环卷积：

$$
x_1[n]\circledast x_2[n]=\sum_{k=0}^{N-1}x[(k)_N]x_2[(n-k)_N]R_N[n]
$$

我们用矩阵的视角看卷积与循环卷积：$x_1[n]=\\{1,1,1\\},x_2[n]=\\{1,1,0,1\\}$，那么其卷积可以写成：

$$
\begin{bmatrix}
1&0&0&0\\
1&1&0&0\\
1&1&1&0\\
0&1&1&1\\
0&0&1&1\\
0&0&0&1\\
\end{bmatrix}\begin{bmatrix}
1\\1\\0\\1
\end{bmatrix}=\begin{bmatrix}
1\\2\\2\\2\\1\\1
\end{bmatrix}
$$

现在看循环卷积，指定$N=4$，那么4点循环卷积为

$$
\begin{bmatrix}
1&0&1&1\\
1&1&0&1\\
1&1&1&0\\
0&1&1&1\\
\end{bmatrix}\begin{bmatrix}
1\\1\\0\\1
\end{bmatrix}=\begin{bmatrix}
2\\3\\2\\2
\end{bmatrix}
$$

类似的，如果指定$N=6$，6点循环卷积为

$$
\begin{bmatrix}
1&0&0&0&1&1\\
1&1&0&0&0&1\\
1&1&1&0&0&0\\
0&1&1&1&0&0\\
0&0&1&1&1&0\\
0&0&0&1&1&1\\
\end{bmatrix}\begin{bmatrix}
1\\1\\0\\1\\0\\0
\end{bmatrix}=\begin{bmatrix}
1\\2\\2\\2\\2\\1
\end{bmatrix}
$$

由此提出离散傅里叶变换的时域卷积定理和频域卷积定理：

- 时域的循环卷积等于频域的乘积；
- 频域的循环卷积正比于频域的乘积.

$$
\text{DFT}\{x_1[n]\circledast x_2[n]\}=X_1[k]\cdot X_2[k]\\
\text{DFT}\{x_1[n]\cdot x_2[n]\}=\frac1NX_1[k]\circledast X_2[k]
$$

因此，我们可以利用DFT实现卷积运算，从而提高效率：

![image-20211224165731923](/img/image-20211224165731923.png)

### 快速傅里叶变换

前面提到的离散傅里叶变换计算复杂度为$O(n^2)$，事实上可以进一步降低复杂度。基本思想是将长序列的DFT分解为短序列DFT。实现这样的分解需要考虑到旋转因子$W_N^{nk}$的性质：

1. 周期性：

   $$
   W_N^{nk}=W_N^{(n+N)k}
   $$

2. 对称性：

   $$
   (W_N^{nk})^*=W_{N}^{-nk}=W_N^{(N-n)k}
   $$

3. 可约性：

   $$
   W_N^{nk}=W_{mN}^{mnk}=W_{N/m}^{nk/m}
   $$

   当然前提是$N/m$为整数。

4. 特殊值：

   $$
   \begin{aligned}
   W_N^0&=1\\
   W_N^{\frac N2}&=-1\\
   W_N^{\frac N4}&=-j\\
   W_N^{k+\frac N2}&=-W_N^{k}\\
   \end{aligned}
   $$

我们对DFT序列进奇偶分解：

$$
\begin{aligned}
X[m]&=\sum_{k=0}^{N-1}x[k]W_N^{km}\\
&=\sum_{r=0}^{N/2-1}x[2r]W^{2rm}_N+\sum_{r=0}^{N/2-1}x[2r+1]W^{(2r+1)m}_N\\
&=\sum_{r=0}^{N/2-1}x[2r]W^{rm}_{N/2}+W_{N}^m\sum_{r=0}^{N/2-1}x[2r+1]W^{rm}_{N/2}\\
&=X_1[m]+W_N^mX_2[m]
\end{aligned}
$$

因此

$$
\begin{aligned}
X[m]&=X_1[m]+W_N^mX2[m]\\
X[m+\frac N2]&=X_1[m]-W_N^mX2[m],m=1,\cdots,\frac N2-1
\end{aligned}
$$

比如我们现在想算八点序列$x[n]=[1,-1,1,-1,2,1,1,2]$的DFT，假设要计算$X[1]$，由上面的式子，我们需要算

$$
\sum_{r=0}^{3}x[2r]W_{4}^{r}+W_{8}^1\sum_{r=0}^{3}x[2r+1]W_{4}^r
$$

观察上面和式的左边，其实算的是序列$x_1[n]=[1,1,2,1]$的离散傅里叶变换的$X_1[1]$，而计算这个$X_1[1]$又可以用到上面的分解方法，我们算的就是

$$
\sum_{r=0}^1x[2r]W_{2}^r+W_{4}^1\sum_{r=0}^1 x[2r+1]W_{2}^{r}
$$

上式的左式又可以进行分拆：

$$
x[0]W_{1}^0+W_{2}^1x[1]W_{1}^0
$$

算的就是子序列$x_{11}=[1,2]$的离散傅里叶变换的$X_{11}[0]$，这样就可以通过递归求解出原序列的离散傅里叶变换，这就是快速傅里叶变换（FFT）的思想。

现在常用蝶形图对算法进行展现，比如2点基2时间抽取FFT算法流图：

![image-20211224175333201](/img/image-20211224175333201.png)

表示

$$
X[0]=x[0]+W_2^0x[1]\\
X[1]=x[0]-W_2^0x[1]\\
$$

对于4点基2时间抽取FFT算法流图：

![image-20211224175545619](/img/image-20211224175545619.png)

而8点基2时间抽取FFT算法流图更为复杂：

![image-20211224175644666](/img/image-20211224175644666.png)

但仍然有规律可循：对于第$M$级蝶形图，系数为$W_{N}^0,\cdots,W{N}^{(N/2-1)}$，蝶形图节点的距离为$N/2$。

#### 利用FFT实现IFFT

考虑离散傅里叶逆变换：

$$
\begin{aligned}
x[n]&=\frac1N\bigg(\sum_{k=0}^{N-1}X[k]W_{N}^{-kn}\bigg)\\
&=\frac1N\bigg(\sum_{k=0}^{N-1}X^*[k]W_{N}^{kn}\bigg)^*\\
\end{aligned}
$$

如此我们又可以先对$X[m]$取共轭，然后用流图计算

$$
\text{DFT}\{X^*[m]\}
$$

取共轭再除以$N$得到结果。

## 拉普拉斯变换

回顾傅里叶变换:

$$
\begin{aligned}
\mathcal{F}[x(t)]&=\int_{-\infty}^{+\infty}x(t)e^{-j\omega t}\mathrm dt\\
\mathcal{F}^{-1}[X(j\omega)]&=\frac1{2\pi}\int_{-\infty}^{+\infty}X(j\omega)e^{j\omega t}\mathrm d\omega\\
\end{aligned}
$$

对于信号$x(t)=e^{at}u(t),a>0$，我们无法求出傅里叶变换，因为积分不收敛，将$x(t)$乘以**衰减因子**$e^{-\sigma}$，就可以满足绝对可积条件，从而算出傅里叶积分:

$$
\begin{aligned}
\int_{-\infty}^{+\infty}x(t)e^{-\sigma}e^{-j\omega t}\mathrm dt
&=\int_{0}^{\infty}e^{(a-s)t}\mathrm dt&s\gets\sigma+j\omega,\sigma>a\\
&=\frac{1}{s-a}
\end{aligned}
$$

从而我们定义出一种新的变换:

$$
\begin{aligned}
\mathcal{F}[x(t)e^{-\sigma t}]&=\int_{-\infty}^\infty x(t)e^{-st}\mathrm dt\\
&=X(s)\\
&=\mathcal{L}[x(t)]
\end{aligned}
$$

该变换就是**拉普拉斯变换**，其逆变换为

$$
x(t)=\frac{1}{2\pi j}\int_{\sigma-j\infty}^{\sigma+j\infty}X(s)e^{st}\mathrm ds
$$

可以发现原来的$\omega$被替换成了$s$，从实数变成了复数。因此，拉普拉斯变换实现的是时域和**复频域**之间的转换，而前面的傅里叶变换是将时域和实频域进行转换。$X(s)$称为复频谱。

### 单边拉普拉斯变换

我们考虑单边拉普拉斯变换:

$$
\begin{aligned}
X(s)&=\int_{0_-}^\infty x(t)e^{-st}\mathrm dt\\
x(t)&=\frac{1}{2\pi j}\int_{\sigma-j\infty}^{\sigma+j\infty}X(s)e^{st}\mathrm ds\\
\end{aligned}
$$

> 注意到单边拉普拉斯变换下，积分下限为$0_{-}$，这是考虑到出现在0时刻的冲激信号。
>
> 同时也要注意，单边拉普拉斯反变换的积分界不变。

从最上面的例子可以看出，并不是所有的$\sigma$都可以有拉普拉斯变换。只有$\sigma$都大，衰减程度越大，才能保证$X(s)$是收敛的。如果有

$$
\lim_{t\to\infty}x(t)e^{-\sigma t}=0,\sigma>\sigma_0
$$

那么则称$\sigma>\sigma_0$为收敛条件，$\sigma_0$称作绝对收敛坐标。图示：

![1](/img/dsp/s_plate.png)

有始有终、能量有限的信号（如冲激信号），收敛区为整个𝑠平面。**有界非周期**信号LT一定存在。比如信号

$$
u(t)-u(t-\tau)
$$

它的收敛域就是整个$s$平面。

而对于$u(t)$，因为其拉普拉斯变换是

$$
\int_0^\infty e^{-st}\mathrm dt
$$

如果要收敛，则$\sigma<0$。类似的，对于$e^{3t}u(t)$，其拉普拉斯变换为

$$
\int_{0}^\infty e^{(3-s)t}\mathrm dt
$$

如果要收敛，则$\sigma>3$.

#### 小记:如何看待复指数中的虚数项

在讨论上面这个收敛性问题时，我们发现，在求收敛轴的时候，我们似乎把$s$和$\sigma$等价看待，也就是说，虚数项$j\omega$似乎可有可无。我们来分析下这个问题，对单边拉普拉斯变换进行展开：

$$
\begin{aligned}
\int_{0_{-}}^{\infty}x(t)e^{-st}\mathrm dt&=\int_{0_{-}}^{\infty}x(t)e^{-(\sigma+j\omega)t}\mathrm dt\\
&=\int_{0_{-}}^\infty x(t) e^{-\sigma t}e^{-j\omega t}\mathrm dt\\
&=\int_{0_{-}}^\infty x(t)\cos\omega t\cdot e^{-\sigma t}\mathrm dt-j\int_{0_{-}}^\infty x(t)\sin\omega t\cdot e^{-\sigma t}\mathrm dt
\end{aligned}
$$

因为

$$
\int_{0_{-}}^\infty x(t)\cos\omega t\cdot e^{-\sigma t}\mathrm dt\leq\int_{0_{-}}^\infty\vert x(t)\vert\cdot e^{-\sigma t}\mathrm dt\\
\int_{0_{-}}^\infty x(t)\sin\omega t\cdot e^{-\sigma t}\mathrm dt\leq\int_{0_{-}}^\infty\vert x(t)\vert\cdot e^{-\sigma t}\mathrm dt
$$

所以如果满足绝对可积:

$$
\int_{0_{-}}^\infty\vert x(t)\vert\cdot e^{-\sigma t}\mathrm dt=C<\infty
$$

那么这个单边拉普拉斯变换就存在，**但反之不成立**。事实上，上式(绝对可积)正是单边LT存在的**充分条件**。

### 拉普拉斯变换的计算

我们这里举几个拉普拉斯变换的例子，便于加深理解。

- 指数型函数的拉普拉斯变换:

  $$
  \begin{aligned}
  \mathcal{L}[e^{(\sigma_0+j\omega_0)t}u(t)]
  &=\int_{0_{-}}^\infty e^{(\sigma_0+j\omega_0)t-st}\mathrm dt\\
  &=\int_0^\infty e^{(\sigma_0-\sigma+j(\omega_0-\omega))t}\mathrm dt\\
  &=\frac{1}{s-(\sigma_0+j\omega_0)}
  \end{aligned}
  $$

  收敛条件为$\sigma_0-\sigma<0$，也就是$\sigma>\sigma_0$。

- 冲激信号：

  $$
  \begin{aligned}
  \mathcal{L}[\delta(t)]
  &=\int_{0_{-}}^\infty\delta(t)e^{-st}\mathrm dt\\
  &=\int_{0_{-}}^{0_{+}}e^{-st}\mathrm dt\\
  &=e^{-st}\vert_0\\
  &=1
  \end{aligned}
  $$

  类似的，对于出现在$t_0(t_0>0)$的冲激信号，我们有

  $$
  \begin{aligned}
  \mathcal{L}[\delta(t-t_0)]
  &=\int_{0_{-}}^\infty\delta(t-t_0)e^{-st}\mathrm dt\\
  &=\int_{t_{0-}}^{t_{0+}}e^{-st}\mathrm dt\\
  &=e^{-st}\vert_{t_0}\\
  &=e^{-st_0}
  \end{aligned}
  $$
  
  因为冲激信号是“有始有终、能量有限”的信号，因此收敛域是整个$s$平面，也就是$\sigma>-\infty$。

- $x(t)=e^{-a(t+1)}u(t+1)$的拉普拉斯变换:

  $$
  \begin{aligned}
  \int_{0_-}^\infty x(t)e^{-st}\mathrm dt
  &=\int_{0_{-}}^\infty e^{-a(t+1)}u(t+1)e^{-st}\mathrm dt\\
  &=\int_{0}^\infty e^{-a(t+1)}e^{-st}\mathrm dt\\
  &=e^{-a}\int_0^\infty e^{(-a-s)t}\mathrm dt\\
  &=\dfrac{e^{-a}}{a+s}
  \end{aligned}
  $$
  收敛条件为$-a-\sigma<0$，也就是$\sigma>-a$.
  
#### 小记:以收敛域的视角看傅里叶变换

观察公式可以发现，傅里叶变换就是拉普拉斯变换的一种特殊情况($\sigma=0$)，对于任意信号，如果其收敛域包含了零点，那么就是可以进行傅里叶变换的，否则就不是。

### 拉普拉斯变换的性质

拉普拉斯变换的不少性质与傅里叶变换相似，因此略去一些证明过程。

#### 线性特性

对于两个时域信号$x_1(t)$和$x_2(t)$，我们有（证明略）

$$
\mathcal{L}[a_1x_1(t)+a_2x_2(t)]=a_1X_1(s)+a_2X_2(s)
$$

设它们的收敛轴分别是$\sigma_1$和$\sigma_2$，那么合成信号的收敛域:

$$
\sigma>\max(\sigma_1,\sigma_2)
$$

比如现在我们要求信号$\delta(t)+e^tu(t)$的拉普拉斯变换:

$$
\begin{aligned}
\mathcal{L}[\delta(t)+e^tu(t)]&=\mathcal{L}[\delta(t)]+\mathcal{L}[e^tu(t)]\\
&=1+\int_{0_{-}}^\infty e^{(1-s)t}\mathrm dt\\
&=1+\frac1{s-1}\\
&=\frac{s}{s-1}&\sigma>1
\end{aligned}
$$

#### 展缩特性

和傅里叶变换类似:

$$
\mathcal{L}[x(at)]=\frac{1}{a}X(\frac{s}{a}),\sigma>a\sigma_0,a>0
$$

我们这里证明一下收敛域:

$$
\begin{aligned}
\mathcal{L}[x(at)]
&=\int_{0_{-}}^\infty x(at)e^{-st}\mathrm dt\\
&=\frac1a\int_{0_{-}}^\infty x(at)e^{-\frac sa at}\mathrm dat &\tau=at\\
&=\frac1a\int_{0_{-}}^\infty x(\tau)e^{-\frac{s}{a}\tau}\mathrm d\tau
\end{aligned}
$$

对于$x(t)$，如果收敛条件为$\sigma>\sigma_0$，那么对于新变换，我们有

$$
\begin{aligned}
\frac{\sigma}{a}&>\sigma_0\\{\sigma}&>a\sigma_0\\
\end{aligned}
$$

#### 时移特性

对$t_0>0$，如果

$$
X(s)=\mathcal{L}[x(t)],\sigma>\sigma_0
$$

那么

$$
e^{-st_0}X(s)=\mathcal{L}[x(t-t_0)u(t-t_0)]
$$

#### 综合运用

假如我们想求下面周期信号的单边LT:

![image-20211217111000688](/img/image-20211217111000688.png)

也就是

$$
x(t)=\sum_{k=0}^\infty x_1(t-k)
$$

其中

$$
x_1(t)=2(u(t)-u(t-1))
$$

运用线性特性和时移特性，我们可以计算出其LT：

$$
\begin{aligned}
\mathcal{L}[x(t)]
&=\mathcal{L}[\sum_{k=0}^\infty x_1(t-2k)]\\
&=\sum_{k=0}^\infty\mathcal{L}[x_1(t-2k)]\\
&=\sum_{k=0}^\infty e^{-2sk}\mathcal{L}[x_1(t)]\\
&=\sum_{k=0}^\infty e^{-2sk}\mathcal{L}[2(u(t)-u(t-1))]\\
&=\sum_{k=0}^\infty2e^{-2sk}\int_{0_{-}}^1e^{-st}\mathrm dt\\
&=2\int_{0_{-}}^1e^{-st}\mathrm dt\sum_{k=0}^\infty e^{-2sk}\\
&=\frac{2}{1-e^{-2s}}\cdot(-\frac{e^{-s}-1}s)\\
&=\frac2{s(1+e^{-s})},\sigma>0
\end{aligned}
$$

再看一个例子，已知$\mathcal{L}[x(t)]=X(s)$，若$a>0,b>0$，求$\mathcal{L}[x(at-b)u(at-b)]$：

我们将信号从$x(t)u(t)$经过一系列变换变成目标信号，先时移再展缩

$$
\begin{aligned}
\mathcal{L}[x(t-b)u(t-b)]&=e^{-bs}X(s)\\
\mathcal{L}[x(at-b)u(at-b)]&=\frac{e^{-\frac{bs}{a}}}aX(\frac sa)\\
\end{aligned}
$$

注意这里的$e^{-bs}$由于是$s$的函数，所以也要进行展缩.

#### 卷积特性

和傅里叶变换类似，也就是时域信号的卷积等于复频域信号的乘积，其收敛域满足

$$
\sigma>\max(\sigma_1,\sigma_2)
$$

#### 乘积特性

类似的，频域的卷积**正比于**时域的乘积:

$$
\mathcal{L}[x_1(t)x_2(t)]=\frac1{2\pi j}[X_1(s)*X_2(s)]
$$

和上面不同的是，其收敛域为

$$
\sigma>\sigma_1+\sigma_2
$$

这是由乘积信号的拉普拉斯变换决定的:

$$
\mathcal{L}[x_1(t)x_2(t)]=\int_{0_{-}}^\infty x_1(t)x_2(t)e^{-st}\mathrm dt
$$

如果与特殊信号相乘，比如指数信号$e^{-\lambda t}$(指数加权)，效果则是平移(参考上面的时移特性):

$$
\mathcal{L}[e^{-\lambda t}x(t)]=X(s+\lambda)
$$

如果是线性加权，效果则是取微分:

$$
\mathcal{L}[-t x(t)]=\dfrac{\mathrm dX(s)}{\mathrm ds}
$$

#### 微分特性

$$
\mathcal{L}[\frac{\mathrm dx(t)}{\mathrm dt}]=sX(s)-x(0_{-}),\sigma>\sigma_0
$$

如果$x(0_{-})=0$，那么微分特性和傅里叶变换中的相同.

不难得出该规律的高阶扩展:

$$
\mathcal{L}[\dfrac{d^nx(t)}{\mathrm d^n t}]=s^nX(s)-\sum_{r=0}^{n-1}s^{n-r-1}x^{(r)}(0_{-})
$$

#### 积分特性

$$
\mathcal{L}[\int_{-\infty}^t x(\tau)\mathrm d\tau]=\frac{X(s)}s+\frac1s\int_{-\infty}^{0_{-}}x(\tau)\mathrm d\tau,\sigma>\max(\sigma_0,0)
$$

为了便于书写，我们会将$\int_{-\infty}^{0_{-}} x(\tau)\mathrm d\tau$简写成$x^{-1}(0_{-})$，如果该值为0，上式可以简化成

$$
\mathcal{L}[\int_{-\infty}^t x(\tau)\mathrm d\tau]=\frac{X(s)}s
$$

#### 综合运用

对下面的信号进行拉普拉斯变换:

![image-20211217230248656](/img/image-20211217230248656.png)

硬算积分当然是可以的:

$$
\int_{0_{-}}^\infty x(t)e^{-st}\mathrm dt=\int_{0}^1te^t\mathrm dt+\int_{1}^2(2-t)e^{-st}\mathrm dt
$$

但我们想利用上面提到的性质进行快速求解。我们对信号求微分，一阶微分:

![image-20211217231002753](/img/image-20211217231002753.png)

二阶微分:

![image-20211217231017971](/img/image-20211217231017971.png)

利用前面提到的微分性质:

$$
\begin{aligned}
\mathcal{L}[\dfrac{\mathrm d^2x(t)}{\mathrm dt^2}]
&=s^2X(s)-sx(0_{-})-x'(0_{-})\\
\int_{0_{-}}^\infty x''(t)e^{-st}\mathrm dt&=s^2X(s)\\
1-2e^{-s}+e^{-2s}&=s^2X(s)\\
X(s)&=\frac{1-2e^{-s}+e^{-2s}}{s^2},\sigma>-\infty
\end{aligned}
$$

除此之外，我们还可以将信号分解为:

$$
x(t)=r(t)-2r(t-1)+r(t-2),r(t)=tu(t)
$$

而$r(t)$的LT很好求得:

$$
\mathcal{L}[tu(t)]=\frac{1}{s^2}
$$

从而利用线性特性和平移特性，求得$x(t)$的拉普拉斯变换:

$$
\begin{aligned}
\mathcal{L}[x(t)]
&=\mathcal{L}[r(t)-2r(t-1)+r(t-2)]\\
&=\mathcal{L}[r(t)]-2\mathcal{L}[r(t-1)]+\mathcal{L}[r(t-2)]\\
&=(1-2e^{-s}+e^{-2s})\mathcal{L}[r(t)]\\
&=\frac{1-2e^{-s}+e^{-2s}}{s^2},\sigma>-\infty\\
\end{aligned}
$$

#### 初值定理和终值定理

对**因果序列**，如果$\mathcal{L}[x(t)]=X(s),\sigma>\sigma_0$，且其导数可进行LT；若$x(t)$在$t=0$不包含**冲激及其各阶导数**，那么

$$
\lim_{t\to0}x(t)=x(0_{+})=\lim_{s\to\infty}sX(s)
$$

初值定理只适用于有理真分式的情况. 若$sX(s)$的收敛域包含$j\omega$轴，也就是收敛轴在负半轴，那么

$$
\lim_{t\to\infty}x(t)=x(\infty)=\lim_{s\to0}sX(s)
$$

#### 拉普拉斯变换和傅里叶变换的关系

我们前面提到过，傅里叶变换就是拉普拉斯变换的一种特殊情况，对于任意信号，如果其收敛域包含了零点，那么就是可以进行傅里叶变换的，否则就不是。

我们考虑特殊情况，也就是收敛域的收敛边界位于$j\omega$轴时，两种变换的关系:

$$
X(j\omega)=X(s)\vert_{s=j\omega}+\pi\sum_{n}K_n\delta(\omega-\omega_n)
$$

其中$K_n$是系数。举例来说，信号

$$
x(t)=\cos 2t\;u(t)
$$

的拉普拉斯变换很好计算:

$$
\mathcal{L}[x(t)]=\frac{s}{s^2+4},\sigma>0
$$

因为收敛边界为$j\omega$轴，因此其傅里叶变换不是简单的将$s$替换为$j\omega$，而是多出一项:

$$
\mathcal{F}[x(t)]=\frac{j\omega}{(j\omega)^2+4}+\frac\pi2[\delta(\omega-2)+\delta(\omega+2)]
$$

### 拉普拉斯逆变换

这里我们考虑如何计算拉普拉斯反变换。

对于LT的结果，一般可表示成

$$
X(s)=\frac{N(s)}{D(s)}=\frac{\sum_{i=0}^mb_is^i}{\sum_{i=0}^na_is^i}
$$

#### 情况1

当$X(s)$是有理真分式，也就是$m<n$，极点是一阶极点(也就是下面的$p_i$互不相等)

$$
\begin{aligned}
X(s)&=\frac{N(s)}{D(s)}\\
&=\frac{N(s)}{\prod_{i=1}^n(s-p_i)}\\
&=\sum_{i=1}^n\frac{k_i}{s-p_i}\\
k_i&=(s-p_i)X(s)\bigg\vert_{s=p_i}\quad i=1,2,\cdots,n\\
x(t)&=u(t)\sum_{i=1}^nk_ie^{p_it}
\end{aligned}
$$

比如我们想求

$$
X(s)=\frac{s+2}{s^3+4s^2+3s}\quad\text{Re}(s)>0
$$

的反变换。按上面的方法进行分解:

$$
X(s)=\frac{k_1}{s}+\frac{k_2}{s+1}+\frac{k_3}{s+3}
$$

然后算出每一个$k_i$:

$$
\begin{aligned}
k_1&=sX(s)\bigg\vert_0=\frac{s+2}{s^2+4s+3}\bigg\vert_0=\frac23\\
k_2&=(s+1)X(s)\bigg\vert_{-1}=\frac{s+2}{s(s+3)}\bigg\vert_{-1}=-\frac12\\
k_3&=(s+3)X(s)\bigg\vert_{-3}=\frac{s+2}{s(s+1)}\bigg\vert_{-3}=-\frac16\\
\end{aligned}
$$

所以信号的拉普拉斯反变换

$$
x(t)=u(t)\sum_{i=1}^3k_ie^{p_it}=(\frac23-\frac12e^{-t}-\frac16e^{-3t})u(t)
$$

#### 情况2

前面讨论的是$X(s)$为有理真分式的情况，现在讨论有理假分式$(m\geq n)$:

$$
X(s)=\frac{N(s)}{D(s)}=\sum_{i=0}^{m-n}B_is^i+\frac{N_1(s)}{D(s)}
$$

我们可以利用下面的公式

$$
\begin{aligned}
\mathcal{L}[B_0]&=B_0\delta(t)\\
\mathcal{L}[B_1s]&=B_1\delta'(t)\\
\mathcal{L}[B_{m-n}s^{m-n}]&=B_{m-n}\delta^{(m-n)}(t)\\
\end{aligned}
$$

对前面的幂次项进行反变换。比如我们想求

$$
X(s)=\dfrac{s^3+5s^2+9s+7}{(s+1)(s+2)}
$$

的反变换，因为不是真分式，我们先进行分解再计算:

$$
\begin{aligned}
X(s)
&=s+2+\frac{s+3}{(s+1)(s+2)}\\
&=s+2+\frac2{s+1}-\frac1{s+2}\\
x(t)&=\delta'(t)+2\delta(t)+(2e^{-t}-e^{-2t})u(t)\\
&=\delta'(t)+2\delta(t)+2e^{-t}-e^{-2t},t\geq0
\end{aligned}
$$

#### 情况3

我们前面讨论的是极点全部是一阶的情形，现在考虑$r$重阶极点:

$$
\begin{aligned}
X(s)
&=\frac{N(s)}{(s-p_1)^r\prod_{i=r+1}^n(s-p_i)}\\
&=\sum_{i=1}^r\frac{k_i}{(s-p_1)^{r+1-i}}+\sum_{i=r+1}^n\frac{k_i}{s-p_i}
\end{aligned}
$$

可以发现后面$n-r$个一阶极点的形式保留了下来，现在看重阶极点上$k_i$的形式:

$$
k_i=\frac1{(i-1)!}\frac{\mathrm d^{i-1}}{ds^{i-1}}[(s-p_1)^2X(s)]\quad i=1,2,\cdots,r
$$

从而反变换的通式为

$$
x(t)=[\sum_{i=1}^r\frac{k_i}{(i-1)!}t^{i-1}e^{p_1t}]u(t)+\sum_{i=r+1}^nk_ie^{p_it}u(t)
$$

上面的公式看起来获取有些抽象，我们来看一个例子，现在要求

$$
X(s)=\frac{s-2}{s(s+1)^3},\text{Re}(s)>0
$$

的反变换，可以发现$-1$是一个三阶重极点

$$
X(s)=\frac{k_1}{(s+1)^3}+\frac{k_2}{(s+1)^2}+\frac{k_3}{s+1}+\frac{k_4}{s}
$$

$k_1$和$k_4$可以按照原来的方式求:

$$
\begin{aligned}
k_1&=(s+1)^3X(s)\bigg\vert_{-1}=\frac{s-2}{s}\bigg\vert_{-1}=3\\
k_4&=sX(s)\bigg\vert_0=\frac{s-2}{(s+1)^3}=-2
\end{aligned}
$$

依照上面的公式，我们用求导的方式解出$k_2$和$k_3$:

$$
\begin{aligned}
k_2&=\frac{\mathrm d(s+1)^3X(s)}{\mathrm ds}\bigg\vert_{-1}=(\frac{s-2}{s})'\bigg\vert_{-1}=2\\
k_3&=\frac12\frac{\mathrm d(s+1)^3X(s)}{\mathrm ds}\bigg\vert_{-1}=\frac12(\frac{s-2}{s})''\bigg\vert_{-1}=2\\
\end{aligned}
$$

> 这里的$\frac12$来自于公式中的$\frac1{(i-1)!}$.

从而

$$
\begin{aligned}
X(s)&=\frac{3}{(s+1)^3}+\frac{2}{(s+1)^2}+\frac{2}{s+1}+\frac{-2}{s}\\
x(t)&=(\frac32t^2e^{-t}+2te^{-t}+2e^{-t}-2)u(t)
\end{aligned}
$$

### 拉普拉斯变换求解系统

利用拉普拉斯变换，我们可以从另一个视角(S域)来对系统的微分方程进行分析。考虑二阶系统响应的求解，给定二阶常系数线性微分方程，已知激励$x(t)$，初始条件$y(0_{-})$和$y'(0_{-})$，求$y(t)$。求解步骤如下：

1. 利用拉普拉斯变换将微分方程转换成S域代数方程；
2. 求解代数方程，解出零输入响应和零状态相应；
3. 利用拉普拉斯反变换求出响应的时域表达式.

上述方式行得通的原因在于：

$$
\begin{aligned}
\mathcal{L}[y''(t)]&=s^2Y(s)-sy(0_{-})-y'(0_{-})\\
\mathcal{L}[y'(t)]&=sY(s)-y(0_{-})\\
\mathcal{L}[y(t)]&=Y(s)
\end{aligned}
$$

因此对于微分方程

$$
y''(t)+a_1y'(t)+a_2y(t)=b_0x''(t)+b_1x'(t)+b_2x(t)
$$

将其转换为S域上的代数方程：

$$
[s^2Y(s)-sy(0_{-})-y'(0_{-})]+a_1[sY(s)-y(0_{-})]+a_2Y(s)\\
=b_0s^2X(s)+b_1sX(s)+b_2X(s)
$$

解得

$$
\begin{aligned}
Y(s)&=\frac{sy(0_{-})+y'(0_{-})+a_1y(0_{-})}{s^2+a_1s+a_2}+\frac{b_0s^2+b_1s+b_2}{s^2+a_1s+a_2}X(s)\\
&=Y_{zi}(s)+Y_{zs}(s)
\end{aligned}
$$

然后对其进行反变换得到系统响应。

还是举个例子，系统的微分方程为

$$
y''(t)+5y'(t)+6y(t)=2x'(t)+8x(t)
$$

激励$x(t)=e^{-t}u(t)$，$y(0_{-})=3, y'(0_{-})=2$，求响应$y(t)$. 通过上式，直接得到

$$
\begin{aligned}
Y(s)=\frac{3s+17}{s^2+5s+6}+\frac{2s+8}{s^2+5s+6}X(s)
\end{aligned}
$$

上式分别是零输入响应和零状态响应的拉普拉斯变换，现在求逆变换：

$$
\begin{aligned}
\mathcal{L}^{-1}[Y_{zi}(s)]
&=\mathcal{L}^{-1}[\frac{3s+17}{s^2+5s+6}]\\
&=\mathcal{L}^{-1}[\frac{11}{s+2}-\frac{8}{s+3}]\\
y_{zi}(t)&=11e^{-2t}-8e^{-3t}\\
\mathcal{L}^{-1}[Y_{zs}(s)]
&=\mathcal{L}^{-1}[\frac{2s+8}{s^2+5s+6}\cdot\frac1{s+1}]\\
&=\mathcal{L}^{-1}[\frac{3}{s+1}-\frac{4}{s+2}+\frac{1}{s+3}]\\
y_{zs}(t)&=3e^{-t}-4e^{-2t}+e^{-3t}
\end{aligned}
$$

由此得到系统的全响应：

$$
y(t)=y_{zi}(t)+y_{zs}(t)=3e^{-t}+7e^{-2t}-7e^{-3t},t\geq0
$$

定义

$$
H(s)=\frac{Y_{zs}(s)}{X(s)}
$$

而恰好

$$
H(s)=\mathcal{L}[h(t)]
$$

$h(t)$就是系统的脉冲相应：

![image-20211225114253466](/img/image-20211225114253466.png)

因此我们有上面两种方法求出零状态响应。

举个例子，给定LTI连续时间系统的微分方程：

$$
y''(t)+3y'(t)+2y(t)=2x'(t)+3x(t),t\geq0
$$

求系统函数$H(s)$和单位冲激响应$h(t)$. 我们直接对两边做拉普拉斯变换：

$$
\begin{aligned}
(s^2+3s+2)Y_{zs}(s)&=(2s+3)X(s)\\
H(s)&=\frac{2s+3}{s^2+3s+2}\\
h(t)&=\mathcal{L}^{-1}[H(s)]\\
&=(e^{-t}+e^{-2t})u(t)
\end{aligned}
$$

### 零极点与时域特性

考虑$H(s)$的零极点分布与$h(t)$的波形特征相对应。因为$H(s)$可以表示为

$$
H(s)=\frac{\prod_{i=1}^m(s-z_i)}{\prod_{i=1}^n(s-p_i)}
$$

$z_i$就是零点，$p_i$是极点，我们可以将这些点在复数域坐标系上绘制出来，比如

$$
H(s)=\frac{s(s-1-j)(s-1-j)}{(s+1)^2(s+2j)(s-2j)}
$$

对应零点和极点的分布图：

![image-20211225135645093](/img/image-20211225135645093.png)

其中$-1$是一个二阶极点。考虑位于$s$轴的单极点：负半轴极点、原点极点和正半轴极点对应不同的反变换图像：

![image-20211225135848043](/img/image-20211225135848043.png)

现在讲情况扩展到整个复平面，则信号开始具有三角函数的特性：

![image-20211225140139485](/img/image-20211225140139485.png)

可以发现，如果一个系统函数的极点都位于左半轴，那么它在时域上最终会收敛。由此引入连续时间LTI系统BIBO稳定性的充分必要条件是

$$
\int_{-\infty}^\infty|h(\tau)|\mathrm d\tau=S<\infty
$$

因果系统在$s$域有界输入有界输出(BIBO)的充要条件是系统函数$H(s)$的全部**极点**位于**左半**𝒔**平面**。

举例来说，如果一系统的系统函数

$$
H_1(s)=\frac{s+3}{(s+1)(s+2)},\text{Re}(s)>-1
$$

因为极点都是负的，都在$s$左半平面，因此系统稳定；而如果系统的稳定函数是

$$
H_2(s)=\frac{s}{s^2+\omega_0^2},\text{Re}(s)>0
$$

极点在虚轴上，所以极点不稳定。

## Z变换

回顾前面提到的拉普拉斯变换：

$$
\begin{aligned}
\mathcal{L}[x(t)]&=\int_{0}^\infty x(t)e^{-st}\mathrm dt\\
\mathcal{L}^{-1}[X(s)]&=\int_{\sigma-j\infty}^{\sigma+j\infty}X(s)e^{st}\mathrm dt
\end{aligned}
$$

现在考虑离散信号：连续因果信号通过抽样得到离散信号:

$$
\begin{aligned}
x_s(t)&=x(t)\cdot\delta_{T_s}(t)=\sum_{n=0}^\infty x(nT_s)\delta(t-nT_s)\\
X_s(s)
&=\int_{0}^\infty x_s(t)e^{-st}\mathrm dt\\
&=\int_{0}^\infty\sum_{n=0}^\infty x(nT_s)\delta(t-nT_s)e^{-st}\mathrm dt\\
&=\sum_{n=0}^\infty x(nT_s)e^{-snT_s}
\end{aligned}
$$

令$z=e^{-sT_s},s=\frac{1}{T_s}\ln z$，我们就得到

$$
X(z)=\sum_{n=0}^\infty x(nT_s)z^{-n}
$$

为了便于讨论，设$T_s=1$，因此

$$
X(z)=\sum_{n=0}^\infty x[n]z^{-n},z=e^s
$$

### 单边Z变换

序列$x[n]$的单边$z$变换定义：

$$
X(z)=\sum_{n=0}^\infty x[n]z^{-n}=x[0]+\frac{x[1]}z+\frac{x[2]}{z^2}+\cdots
$$

事实上Z变换的结果就是一个无穷级数。与拉普拉斯变换相似，我们也希望上式收敛，对应$z$必须处于收敛域内。显然$z$越大越容易收敛，也就是$\vert z\vert>R_x$，对应的是$z$平面的一圆外区域：

![image-20211219200737581](/img/image-20211219200737581.png)

我们来看几个常见信号的Z变换。

- 单位脉冲序列：

  $$
  \mathcal{Z}\{\delta[n]\}=1
  $$
  
  显然收敛域是整个z平面，也就是$z\ge0$。
  
- 单位阶跃序列：

  $$
  \begin{aligned}
  \mathcal{Z}\{u[n]\}&=\sum_{n=0}^\infty z^{-i}\\
  &=\frac1{1-z^{-1}}
  \end{aligned}
  $$

  如果收敛，必然要求$\vert z\vert>1$。

- 斜变序列：

  $$
  \begin{aligned}
  \mathcal{Z}[x[n]]
  &=\mathcal{Z}[nu[n]]\\
  &=\sum_{n=0}^\infty nz^{-n}\\
  \end{aligned}
  $$

  考虑阶跃序列的Z变换

  $$
  \sum_{n=0}^\infty z^{-n}=\frac{1}{1-z^{-1}},\vert z\vert>1
  $$

  对两边进行求导

  $$
  \sum_{n=0}^\infty n(z^{-1})^{n-1}=\frac{1}{(1-z^{-1})^2}
  $$

  因此斜变序列的$z$变换为

  $$
  \sum_{n=0}^\infty nz^{-n}=\frac{z^{-1}}{(1-z^{-1})^2},\vert{z}\vert>1
  $$

- 指数序列：

  $$
  X(z)=\mathcal{Z}[a^nu[n]]=\sum_{n=0}^\infty a^nz^{-n}=\frac1{1-az^{-1}},\vert{z}\vert>\vert{a}\vert
  $$
  
### 双边Z变换

单边Z变换下的求和是从0到无穷，这里考虑双边$Z$变换，也就是对全体整数求和：

$$
X(z)=\sum_{n=-\infty}^\infty x[n]z^{-n}
$$

同时引入Z反变换：

$$
x[n]=\mathcal{Z}^{-1}\{X(z)\}=\frac1{2\pi j}\oint_cX(z)z^{n-1}\mathrm dz
$$

考虑之前的拉普拉斯反变换是沿着收敛轴$\text{Re}(s)=\sigma$进行积分，这里收敛域边界是Z平面上的闭合曲线，因此采用环路积分。

### Z变换的性质

#### 线性特性

给定两离散信号$x_1[n]$和$x_2[n]$，对应的$Z$变换就是$X_1(z)$和$X_2(z)$，收敛域分别是$R_{x1}$和$R_{x2}$，则我们有

$$
\mathcal{Z}[ax_1[n]+bx_2[n]]=aX_1(z)+bX_2(z),\vert z\vert>\max(R_{x1},R_{x2})
$$

我们现在想求信号$x[n]=\cos(\omega_0 n)u[n]$的Z变换:

$$
\begin{aligned}
\mathcal{Z}\{x[n]\}
&=\mathcal{Z}\{(\frac12e^{j\omega_0n}+\frac12e^{-j\omega_0 n})u[n]\}\\
&=\frac12\mathcal{Z}\{e^{j\omega_0n}u[n]\}+\frac12\mathcal{Z}\{e^{-j\omega_0n}u[n]\}\\
&=\frac12\frac1{1-e^{j\omega_0}z^{-1}}+\frac12\frac1{1-e^{-j\omega_0}z^{-1}}\\
&=\frac12\frac{2-(e^{j\omega_0}+e^{-j\omega_0})z^{-1}}{1-(e^{j\omega_0}+e^{-j\omega_0})z^{-1}+z^{-2}}\\
&=\frac{1-\cos\omega_0 z^{-1}}{1-2z^{-1}\cos\omega_0+z^{-2}},\vert{z}\vert>1
\end{aligned}
$$

类似的

$$
\mathcal{Z}[\sin(\omega_0n)u[n]]=\frac{\sin\omega_0 z^{-1}}{1-2z^{-1}\cos\omega_0+z^{-2}},\vert{z}\vert>1
$$

#### 位移特性

已知$\mathcal{Z}[x[n]]=X(z),\vert{z}\vert>R_x$，因果序列的位移满足

$$
\mathcal{Z}\{x[n-k]u[n-k]\}=z^{-k}X(z),\vert{z}\vert>R_x
$$

如果不是因果序列，则

$$
\begin{aligned}
\mathcal{Z}\{x[n+k]u[n]\}&=x^k[X(z)-\sum_{n=0}^{k-1}x[n]z^{-n}],\vert z\vert>R_x\\
\mathcal{Z}\{x[n-k]u[n]\}&=x^{-k}[X(z)+\sum_{n=-k}^{-1}x[n]z^{-n}],\vert z\vert>R_x\\
\end{aligned}
$$

我们尝试证明上面的结论，先看因果序列的位移

$$
\begin{aligned}
\mathcal{Z}\{x[n-k]u[n-k]\}
&=\sum_{n=0}^\infty x[n-k]u[n-k]z^{-n}\\
&=z^{-k}\sum_{n=0}^\infty x[n-k]u[n-k]z^{-(n-k)}\\
&=z^{-k}\sum_{n=k}^\infty x[n-k]u[n-k]z^{-(n-k)}\\
&=z^{-k}\sum_{n=0}^\infty x[n]u[n]z^{-n}\\
&=z^{-k}X(z)
\end{aligned}
$$

现在考虑非因果序列，左移:

$$
\begin{aligned}
\mathcal{Z}\{x[n+k]u[n]\}
&=\sum_{n=0}^\infty x[n+k]u[n]z^{-n}\\
&=z^{k}\sum_{n=0}^\infty x[n+k]u[n]z^{-(n+k)}\\
&=z^{k}\sum_{n=k}^\infty x[n]z^{-n}\\
&=z^{k}\bigg[\sum_{n=0}^\infty x[n]z^{-n}-\sum_{n=0}^{k-1}x[n]z^{-n}\bigg]\\
&=z^k\bigg[X(z)-\sum_{n=0}^{k-1}x[n]z^{-n}\bigg]
\end{aligned}
$$

右移变换的证明与上面类似，这里不做过多赘述。

假如我们现在想求信号

$$
R_N[n]=u[n]-u[n-N]
$$

的Z变换和收敛域，利用线性特性和因果信号位移特性，我们有

$$
\begin{aligned}
\mathcal{Z}\{R_N[n]\}&=\mathcal{Z}\{u[n]\}-\mathcal{Z}\{u[n-N]\}\\
&=\frac1{1-z^{-1}}-z^{-N}\frac{1}{1-z^{-1}}\\
&=\frac{1-z^{-N}}{1-z^{-1}}
\end{aligned}
$$

**因为该信号是有限长序列，所以收敛域为整个Z平面**。也就是说，线性加权后序列z变换的收敛域可能比原序列z变换的收敛域大。

#### 指数加权

$$
\begin{aligned}
\mathcal{Z}\{a^nx[n]\}&=\sum_{n=0}^\infty a^nz^{-n}\\
&=\sum_{n=0}^\infty(\frac{z}{a})^{-n}\\
&=X(\frac za),\vert z\vert>\vert a\vert R_x
\end{aligned}
$$

所以信号

$$
x[n]=a^n\cos(\omega_0 n)u[n]
$$

的Z变换就是

$$
\begin{aligned}
\mathcal{Z}\{x[n]\}
&=\frac{1-\cos\omega_0 {(z/a)}^{-1}}{1-2{(z/a)}^{-1}\cos\omega_0+{(z/a)}^{-2}}\\
&=\frac{1-a\cos\omega_0 {z}^{-1}}{1-2a{z}^{-1}\cos\omega_0+a^2{z}^{-2}}\\
\end{aligned}
$$

#### Z域微分特性

$$
\begin{aligned}
\mathcal{Z}\{nx[n]\}
&=\sum_{n=0}^\infty nx[n]z^{-n}\\
&=-z\sum_{n=0}^\infty -nx[n]z^{-n-1}\\
&=-z\sum_{n=0}^\infty x[n]\frac{\mathrm d z^{-n}}{\mathrm dz}\\
&=-z\frac{\mathrm d}{\mathrm dz}\sum_{n=0}^\infty x[n]z^{-n}\\
&=-z\frac{\mathrm dX(z)}{\mathrm dz},\vert{z}\vert>R_x
\end{aligned}
$$

比如我们现在要求$x[n]=(n+1)a^nu[n]$的Z变换和收敛域，考虑到

$$
\mathcal{Z}[a^nu[n]]=\frac1{1-az^{-1}},\vert z\vert>\vert a\vert
$$

利用上面的性质，我们有

$$
\mathcal{Z}\{na^nu[n]\}=-z\frac{\mathrm d}{\mathrm dz}\frac1{1-az^{-1}}=\frac{az^{-1}}{(1-az^{-1})^2},|z|>|a|
$$

然后利用线性特性得到最终结果：

$$
\mathcal{Z}\{(n+1)a^nu[n]\}=\mathcal{Z}\{na^nu[n]\}+\mathcal{Z}\{a^nu[n]\}=\frac1{(1-az^{-1})^2},|z|>|a|
$$

#### 序列卷积

我们考察Z变换是否仍然有序列卷积的性质：

$$
\begin{aligned}
\mathcal{Z}\{x_1[n]*x_2[n]\}
&=\sum_{n=0}^{\infty}x_1[n]*x_2[n]z^{-n}\\
&=\sum_{n=0}^\infty\sum_{k=0}^\infty x_1[k]x_2[n-k]z^{-n}\\
&=\sum_{k=0}^\infty x_1[k]\sum_{n=0}^\infty x_2[n-k]z^{-n}\\
&=\sum_{k=0}^\infty x_1[k]z^{-k} X_2(z)\\
&=X_1(z)X_2(z)
\end{aligned}
$$

我们证明出卷积的Z变换等于Z变换的乘积。至于收敛域，显然我们上式的两次Z变换都需要满足，因此收敛域$\vert z\vert\in R_{x_1}\cap R_{x_2}$。

#### 初值定理与终值定理

与拉普拉斯变换类似，Z变换也有对应的初值定理和终值定理。

$$
x[0]=\lim_{z\to\infty}X(z)
$$

若$(z-1)X(z)$的收敛域包含单位圆，则

$$
x[\infty]=\lim_{z\to 1}(z-1)X(z)
$$

比如，已知

$$
X(z)=\frac1{1-az^{-1}},|z|>|a|
$$

那么

$$
\begin{aligned}
x[0]&=\lim_{z\to\infty}X(z)=1\\
x[1]&=\lim_{z\to\infty}\mathcal{Z}\{x[n+1]\}\\
&=\lim_{z\to\infty}z(X(z)-x[0])\\
&=a\\
x[\infty]&=\lim_{z\to1}(z-1)X(z)\\
&=\lim_{z\to1}\frac{z-1}{1-az^{-1}}\\
&=0
\end{aligned}
$$

#### 总结

我们对Z变换的性质进行总结：

![image-20211220174637079](/img/image-20211220174637079.png)

可以发现Z变换的很多性质继承自拉普拉斯变换，下图是两种变换的性质比较：

![image-20211220174739776](/img/image-20211220174739776.png)

### Z逆变换

这里我们考虑Z反变换。根据定义，单边Z反变换是一个环路积分：

$$
x[n]=\frac1{2\pi j}\oint_{c}X(z)z^{k-1}\mathrm dz
$$

$C$就是Z变换的收敛域边缘线。但这样计算过于复杂，我们还是考虑部分分式展开法计算。

先看常见信号的Z变换，它们可以为反变换计算提供帮助：

![image-20211225143251655](/img/image-20211225143251655.png)

事实上我们更喜欢形式一，注意到不少典型信号的Z变换中，形式一更加简单。

与拉普拉斯反变换类似，部分分式法将Z变换的结果表示为

$$
X(z)=\frac{b_0+b_1z^{-1}+\cdots+b_mz^{-m}}{1+a_1z^{-1}+\cdots+a_nz^{-n}}
$$

先考虑最简单的情形，也就是$m<n$且分母无重根，那么

$$
X(z)=\sum_{i=1}^n\frac{r_i}{1-p_iz^{-1}}
$$

我们也不难求出系数$r_i$:

$$
r_i=(1-p_iz^{-1})X(z)\bigg\vert_{z=p_i}
$$

按照上表可以得出其逆变换

$$
\mathcal{Z}^{-1}[X(z)]=(\sum_{i=1}^nr_ip_i^n)u[n]
$$

考虑$m<n$，但分母在$z=u$处有$l$阶重极点：

$$
X(z)=\sum_{i=1}^{n-l}\frac{r_i}{1-p_iz^{-1}}+\sum_{i=0}^{l-1}\frac{q_i}{(1-uz^{-1})^{l-i}}
$$

其中系数

$$
q_i=\frac{1}{(-u)^ii!}\frac{\mathrm d^i}{\mathrm d(z^{-1})^i}[(1-uz^{-1})^lX(z)]\bigg\vert_{z=u},i=0,\cdots,l-1
$$

然后对这些重根对应的Z变换，比如二重根

$$
\frac1{(1-az^{-1})^2}
$$

对应的是

$$
(n+1)a^nu[n]
$$

对于更高幂次的情况，我们考虑微分性质求解。

再考虑$m\ge n$的情况，经过分解得到一个多项式和一个真分式，对于真分式可按照前面的方式求解。

再考虑共轭复根的情况，比如现在有Z变换

$$
X(z)=\frac{z^2}{z^2+a^2}=\frac{1}{1+a^2z^{-2}}
$$

考虑

$$
\mathcal{Z}\{\sin(\omega_0n)u[n]\}=\frac{\sin\omega_0z^{-1}}{1-2z^{-1}\cos\omega_0+z^{-2}}
$$

我们想消去分子的$z^{-1}$，于是利用唯一特性：

$$
\mathcal{Z}\{\sin(\omega_0(n+1))u[n]\}=\frac{\sin\omega_0}{1-2z^{-1}\cos\omega_0+z^{-2}}
$$

再考虑指数加权可以在$z$前面增加系数，因此其逆变换

$$
x[n]=a^{n}\sin(\frac\pi2(n+1))u[n]=a^{n}\cos(\frac\pi2n)u[n]
$$

### Z变换求解系统

类似拉普拉斯变换能够将微分方程转换成代数方程求解，Z变换也能够求解差分方程。我们可以通过Z变换的性质

$$
\begin{aligned}
\mathcal{Z}\{y[n-1]u[n]\}&=z^{-1}Y(z)+y[-1]\\
\mathcal{Z}\{y[n-2]u[n]\}&=z^{-2}Y(z)+y[-1]z^{-1}+y[-2]\\
\end{aligned}
$$

去转换差分方程

$$
y[n]+a_1y[n-1]+a_2y[n-2]=b_0x[n]+b_1x[n-1],n\geq0
$$

整理得到

$$
\begin{aligned}
Y(z)&=Y_{zi}(z)+Y_{zs}(z)\\
&=\frac{a_2y[-1]z^{-1}+a_1y[-1]+a_2y[-2]}{1+a_1z^{-1}+a_2z^{-2}}+\frac{b_0+b_1z^{-1}}{1+a_1z^{-1}+a_2z^{-2}}X(z)
\end{aligned}
$$

然后对$Y(z)$进行Z逆变换即可得到原系统响应。

同样的，离散系统在零状态条件下，输出Z变换与输入Z变换的比记为$H(z)$：

$$
H(z)=\frac{Y_{zs}(z)}{X(z)}
$$

对应单位冲激响应的Z变换：

$$
H(z)=\mathcal{Z}\{h[n]\}
$$

因此我们可以通过这种方法求出系统的单位冲激响应。比如某离散系统的差分方程是

$$
y[n]-ay[n-1]=bx[n]
$$

要求系统函数$H(z)$和$h[n]$：

$$
\begin{aligned}
Y(z)-a[z^{-1}Y(z)-y[n-1]]&=bX(z)\\
Y(z)&=\frac{bX(z)-ay[n-1]}{1-az^{-1}}\\
H(z)&=\frac{Y(z)}{X(z)}\\
&=\frac{b}{1-az^{-1}}\\
h(n)&=b(a^n)u[n]
\end{aligned}
$$

类似拉普拉斯变换，我们也可以考虑Z变换后的零极点在Z平面上的分布。系统的时域特性主要取绝于系统的**极点**。

![image-20211226112623736](/img/image-20211226112623736.png)

上图是不同位置的极点的Z变换在时域上的表现，可以发现Z变换的时域收敛性以单位圆为界：圆内收敛，圆外发散。

引入离散LTI系统的稳定充要条件：

$$
\sum_{n=-\infty}^\infty\vert h[n]\vert<\infty
$$

通过$H(z)$判断稳定性：

- $H(z)$的收敛域包含单位圆则系统稳定；
- 因果系统的极点全在单位圆内则该系统稳定.

比如下面的因果LTI离散系统：

$$
H(z)=\frac1{(1-0.5z^{-1})(1-1.5z^{-1})}
$$

考虑收敛域，收敛域为$\vert z\vert>1.5$，不包含单位圆，因此不稳定；考虑极点，极点$z_2=1.5$在单位圆外，系统不稳定。
