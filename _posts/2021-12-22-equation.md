---
layout:     post
title:      微分方程与差分方程的求解
subtitle:   数字信号处理复习
date:       2021-12-22
author:     Welt Xing
header-img: img/dsp/background.jpg
catalog:    true
tags:
    - 数字信号处理
---

## 引入

系统数学模型的时域表示常常会用微分/差分方程描述。如果组成系统的原件都是参数恒定的线性元件，则相应的数学模型是一个**线性常系数常微分方程**。若此时系统中各元件起始无储能，则构成一个线性时不变系统。

下面是微分方程的一般形式：

$$
\frac{\mathrm d^N}{\mathrm dt^N}y(t)+a_{N-1}\frac{\mathrm d^{N-1}}{\mathrm dt^{N-1}}y(t)+\cdots a_1\frac{\mathrm d}{\mathrm dt}y(t)+a_0y(t)\\
=\frac{\mathrm d^M}{\mathrm dt^M}x(t)+b_{M-1}\frac{\mathrm d^{M-1}}{\mathrm dt^{M-1}}x(t)+\cdots b_1\frac{\mathrm d}{\mathrm dt}x(t)+b_0x(t)\tag{1}
$$

$a_i,b_i$都是常数；一般$N>M$。

后向差分方程（离散系统）：

$$
\sum_{i=0}^Na_iy[n-i]=\sum_{j=0}^Nb_jx[n-j]\tag{2}
$$

一个线性时不变（LTI）系统可以用常系数微分方程或常系数差分方程描述，但一个常系数微分方程或差分方程描述的系统不一定是线性时不变系统。

## 微分方程求解

我们考虑微分方程的求解，其完全解有**齐次解$y_h(t)$**和**特解$y_p(t)$**构成。齐次解就是输入有关的各项全部为0时方程的解，也就是(1)式右端为0。特解是方程的任意一个解。

### 求齐次解

求齐次解，就是求下面的方程：

$$
\frac{\mathrm d^N}{\mathrm dt^N}y(t)+a_{N-1}\frac{\mathrm d^{N-1}}{\mathrm dt^{N-1}}y(t)+\cdots a_1\frac{\mathrm d}{\mathrm dt}y(t)+a_0y(t)=0\tag{3}
$$

齐次解为形如$Ae^{\alpha t}$函数的线性组合，代入有

$$
A\alpha^Ne^{\alpha t}+Aa_{N-1}\alpha^{N-1}e^{\alpha t}+\cdots+Aa_0e^{\alpha t}=0\tag{4}
$$

因此我们实际上求的是下面的$N$阶方程(特征方程)：

$$
\alpha^N+a_{N-1}\alpha^{N-1}+\cdots+a_0=0\tag{5}
$$

解出$N$个解(特征根)：$\alpha_1,\cdots,\alpha_N$。如果没有重根，那么齐次解为

$$
y_h(t)=\sum_{i=1}^NA_ie^{\alpha_it}\tag{6}
$$

$A_i$为待定系数。如果有共轭复根，$\alpha_1=m+jn,\alpha_2=m-jn$，则根据欧拉公式，我们有

$$
\begin{aligned}
y_h(t)&=A_1e^{\alpha_1t}+A_2e^{\alpha_2t}\\
&=e^{mt}((A_1+A_2)\cos nt+(A_1-A_2)\sin nt)
\end{aligned}\tag{7}
$$

现在考虑有重根的情况，假设$\alpha_1$为$k$阶重根，也就是原方程可以分解为

$$
(\alpha-\alpha_1)^k\prod_{i=2}^{N-k+1}(\alpha-\alpha_i)=0\tag{8}
$$

其齐次解为

$$
y_h(t)=(\sum_{i=1}^kA_it^{k-i})e^{\alpha_1t}+\sum_{i=2}^{N-k+1}A_ie^{\alpha_it}\tag{9}
$$

比如我们想求下面微分方程的齐次解

$$
y^{(3)}(t)+7y''(t)+16y'(t)+12y(t)=x(t)
$$

由上面的规则，先求特征方程

$$
\alpha^3+7\alpha^2+16\alpha+12=(\alpha+2)^2(\alpha+3)=0
$$

也就是一个二重根$\alpha_1=-2,\alpha_2=-3$，因此齐次解为

$$
y_h(t)=(A_1t+A_2)e^{-2t}+A_3e^{-3t}
$$

因为缺少初始条件，因此我们无法继续求出待定系数。

### 求特解

现在考虑求特解，特解的形式和激励函数的形式有关，通过代入激励函数，观察形式，代入微分方程求解待定系数。下表可以为我们求特解提供参考：

<img src="/img/image-20211222190859027.png" alt="image-20211222190859027" style="zoom: 80%;" />

- 如果特解和齐次解重复，比如都是$e^{at}$，那么将特解设为$B_0te^{at}$；
- 若对应的特征根为二重根，齐次解为$te^{at}$，特解为$B_0t^2e^{at}$；
- 若特解为0时刻加入，则微分方程的解区间为$0_+\leq t<\infty$.

上面的描述或许有点抽象，我们来一个例子，给定微分方程

$$
y^{(2)}(t)+2y'(t)+3y(t)=x'(t)+x(t)
$$

设$x(t)=t^2$，求特解。

微分方程的右端是$t^2+2t$，参考上表，激励函数是$t^p$类型的，$p=2$，因此我们设特解形式为

$$
y_p(t)=B_1t^2+B_2t+B_3
$$

代入求解得到

$$
\begin{cases}
B_1=\frac13\\
B_2=\frac29\\
B_3=-\frac{10}{27}\\
\end{cases}
$$

因此特解为$y_p(t)=\frac13t^2+\frac29t-\frac{10}{27}$。

### 求待定系数

现在考虑基于初始条件求待定系数，然后就可以得到完整的微分方程解。

例：微分方程

$$
y^{(2)}(t)+7y'(t)+6y(t)=6\sin(2t),t\geq0
$$

边界条件为$y(0)=0,y'(0)=0$，要求解这个方程。

三步走：求齐次解→求特解→求待定系数。先求齐次解：

$$
\alpha^2+7\alpha+6=(\alpha+1)(\alpha+6)=0
$$

因此齐次解为

$$
y_h(t)=A_1e^{-t}+A_2e^{-6t}
$$

再求特解，考虑输入为三角函数，故特解形式为

$$
y_p(t)=B_1\sin(2t)+B_2\cos(2t)
$$

代入得到特解

$$
y_p(t)=\frac3{50}\sin(2t)-\frac{21}{50}\cos(2t)
$$

因此微分方程的解：

$$
y(t)=y_h(t)+y_p(t)=A_1e^{-t}+A_2e^{-6t}+\frac3{50}\sin(2t)-\frac{21}{50}\cos(2t)
$$

考虑边界条件，得到方程组并求解

$$
\begin{cases}
A_1+A_2-\frac{21}{50}=0\\
-A_1-6A_2+\frac3{25}=0
\end{cases}\to\begin{cases}
A_1=\frac{12}{25}\\
A_2=-\frac3{50}
\end{cases}
$$

从而得到微分方程的解

$$
y(t)=\frac{12}{25}e^{-t}-\frac3{50}e^{-6t}+\frac3{50}\sin(2t)-\frac{21}{50}\cos(2t)
$$

## 差分方程求解

差分方程的齐次解就是下面方程的解

$$
\sum_{i=0}^Na_iy[n-i]=0
$$

齐次解为形如$C\alpha^n$函数的线性组合，令$y[n]=C\alpha^n$，则有特征方程

$$
a_0\alpha^N+a_1\alpha^{N-1}+\cdots+a_N=0
$$

解得$N$个特征根$\alpha_1,\cdots,\alpha_N$。

可以发现上述过程与微分方程的齐次解求解过程相似：

<img src="/img/image-20211222194827839.png" alt="image-20211222194827839" style="zoom:67%;" />

类似的，我们接下来考虑求特解，方法与求微分方程特解相似：

<img src="/img/image-20211222195039807.png" alt="image-20211222195039807" style="zoom:67%;" />

再来看一个例子：激励信号$x[n]=(\frac12)^nu[n],y[-1]=0,y[-2]=1,y[-3]=\frac12$，求差分方程

$$
y[n]+\frac13y[n-1]-\frac59y[n-2]+\frac19y[n-3]=x[n]-x[n-1]
$$

的完全相应。

仍是三步走：求齐次解→求特解→求待定系数。先求齐次解

$$
\alpha^3+\frac13\alpha^2-\frac59\alpha+\frac19=\frac19(3\alpha-1)^2(\alpha+1)
$$

也就是$\alpha_1=-1$，一个二重根$\alpha_2=\alpha_3=\frac13$，因此齐次解为

$$
y_h[n]=A_1(-1)^n+(A_2+A_3n)(\frac13)^n
$$

然后求特解，考虑激励信号的形式，查表，设特解为

$$
y_p[n]=C(\frac12)^n
$$

代入解得$C=-3$。因此特解为

$$
y_p[n]=-3(\frac12)^n
$$

所以差分方程的解

$$
y[n]=y_h[n]+y_p[n]=A_1(-1)^n+(A_2+A_3n)(\frac13)^n-3(\frac12)^n
$$

现在求待定系数，注意我们不能将原条件直接代入，因为在$n<0$时$y[n]$不满足上述方程，所以应求出$n=0,1,2$时系统的输出：

$$
\begin{cases}
y[0]+\frac13y[-1]-\frac59y[-2]+\frac19y[-3]=x[0]-x[-1]\\
y[1]+\frac13y[0]-\frac59y[-1]+\frac19y[-2]=x[1]-x[0]\\
y[2]+\frac13y[1]-\frac59y[0]+\frac19y[-1]=x[2]-x[1]\\
\end{cases}\to\begin{cases}
y[0]=\frac32\\
y[1]=-\frac{10}9\\
y[2]=\frac{103}{108}\\
\end{cases}
$$

再用这三个初始值来求出待定系数，得到最后的完全解：

$$
y[n]=\frac{35}{12}(-1)^n+(\frac{109}{32}+\frac{25}{24}n)(\frac13)^n-3(\frac12)^n,n\ge0
$$
