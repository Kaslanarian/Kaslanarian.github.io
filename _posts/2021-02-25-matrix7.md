---
layout:     post
title:      C++构建Matrix类(6)
subtitle:   求多解线性方程组
date:       2021-02-23
author:     Welt Xing
header-img: img/matrix_equations.png
catalog:    true
categories: matrix-c
tags:
    - matrix-c
    - 线性代数
---

我们将尝试解下面方程组：

$$
\begin{cases}
x_1+5x_2-x_3-x_4=-1\\
x_1-2x_2+x_3+3x_4=3\\
3x_1+8x_2-x_3+x_4=1\\
x_1-9x_2+3x_5+7x_4=7\\
\end{cases}
$$

先将该方程组的增广矩阵阶梯化：

$$
\begin{bmatrix}
1 & 5 & -1&-1&-1\\
0&-7&2&4&4\\
0&0&0&0&0\\
0&0&0&0&0\\
\end{bmatrix}
$$

## 解出一个特殊解

最简单的方法是将所有的**非主元**设为$0$，然后去解剩下的主元方程组。

主元：阶梯型增广矩阵的每一个非零行的第一个非$0$元素的列数对应的未知数就是主元；

本题中的第一行和第二行为非零行，第一行的第一个非零元素在第一列，所以$x_1$是主元，同理，根据第二行，$x_2$也是主元，我们的特解结构为：

$$
\begin{bmatrix}
x_1&x_2&0&0
\end{bmatrix}^\top
$$

我们只需要解方程组：

$$
\begin{cases}
x_1+5x_2=-1\\
-7x_2=4\\
\end{cases}
$$

可以证明删减后的方程组必然是$A_{r\times r}x=b_r$结构的唯一解方程组，其中$r$为增广矩阵的秩。

从上一篇文章中，我们知道：

$$
\begin{bmatrix}
x_1\\x_2
\end{bmatrix}=\begin{bmatrix}
1&5\\0&-7
\end{bmatrix}^{-1}\begin{bmatrix}
-1\\4
\end{bmatrix}=\begin{bmatrix}
\frac{13}{7}\\-\frac{4}{7}
\end{bmatrix}
$$

所以一个特解是：

$$
\begin{bmatrix}
\frac{13}{7}\\-\frac{4}{7}\\0\\0
\end{bmatrix}
$$

接下来需要解齐次线性方程组：

$$
\begin{cases}
x_1+5x_2-x_3-x_4=0 \\
x_1-2x_2+x_3+3x_4=0 \\
3x_1+8x_2-x_3+x_4=0 \\
x_1-9x_2+3x_5+7x_4=0\\
\end{cases}
$$

## 齐次线性方程组的解法

我们仍是对系数矩阵进行阶梯型变换，而我们之前已经实现了，所以只需要解：

$$
\begin{bmatrix}
1 & 5 & -1 & -1\\
0 &-7 & 2 & 4\\
\end{bmatrix}
$$

主元：$x_1$，$x_2$；非主元：$x_3$，$x_4$。主元数量为$rank(A)$，简写为$r$，$n$是未知数数量，非主元数量为$n-r$，我们需要解$n-r$次$A_{r\times r}x=b_r$型的唯一解线性方程组，每一次的解就是基础解析$(\beta_1,\beta_2,...,\beta_{n-r})$的一个向量。与上面求特解时将非主元全设为$0$不同，在解第$i$次方程组时，就要将第$i$个非主元设为$1$，其余仍是0：

- 第1次：我们需要将第一个非主元设为1，其余为0：

    $$
    \beta_1=
    \begin{bmatrix}
    x_1&x_2&1&0
    \end{bmatrix}^\top
    $$

    即解方程：

    $$
     \begin{bmatrix}
    1 & 5 & -1 & -1\\
    0 &-7 & 2 & 4\\
    \end{bmatrix}\beta_1=0
    $$

    规范化：

    $$
    \begin{bmatrix}
    1&5\\0&-7
    \end{bmatrix}\begin{bmatrix}
    x_1\\x_2
    \end{bmatrix}=\begin{bmatrix}
    1\\-2
    \end{bmatrix}
    $$

    解得：

    $$
    \begin{cases}
    x_1=-\frac{3}{7} \\
    x_2= \frac{2}{7} \\
    \end{cases}
    $$

    所以$\beta_1=\begin{bmatrix}-\frac{3}{7}&\frac{2}{7}&1&0\end{bmatrix}^\top$

- 第2次，将第二个非主元设为1，其余为0：

    $$
    \beta_2=
    \begin{bmatrix}
    x_1&x_2&0&1
    \end{bmatrix}^\top
    $$

    即解方程：

    $$
     \begin{bmatrix}
    1 & 5 & -1 & -1\\
    0 &-7 & 2 & 4\\
    \end{bmatrix}\beta_2=0
    $$

    规范化：

    $$
    \begin{bmatrix}
    1&5\\0&-7
    \end{bmatrix}\begin{bmatrix}
    x_1\\x_2
    \end{bmatrix}=\begin{bmatrix}
    1\\-4
    \end{bmatrix}
    $$

    解得：

    $$
    \begin{cases}
    x_1=-\frac{13}{7} \\
    x_2= \frac{4}{7} \\
    \end{cases}
    $$

    所以$\beta_2=\begin{bmatrix}-\frac{13}{7}&\frac{4}{7}&1&0\end{bmatrix}^\top$