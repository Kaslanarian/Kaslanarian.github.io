---
layout:     post
title:      Tmux
subtitle:   简单使用
date:       2021-03-18
author:     Welt Xing
header-img: img/tmux-tips.png
catalog:    true
tags:
    - 其它
---

## 引言

在学习ROS时，需要开启多个终端，如果只用Ubuntu提供的基本终端，是无法满足需要的，事实上，去年的《计算机系统基础》课程已经提及并推荐使用过一种工具：$\text{Tmux}$，但由于它对当时简单的单终端任务并无多大帮助，随即弃用。这里再次拾起$\text{Tmux}$，以作记录.

你可以在[这里](https://github.com/tmux/tmux/wiki)获取Tmux的官方信息.

## 安装

我们只需要输入：

```bash
sudo apt install tmux
```

就可以安装Tmux.

## Tmux初探

安装好后我们先输入命令看看：

```bash
$tmux
```

![tmux](/img/only_tmux.png)

输入`exit`便可以退出.

我们发现也只是终端底部多出一个提示信息，此外和我们一般的终端别无二致，分屏功能呢？

我们使用`tldr`命令来看看tmux的操作：

```bash
tmux
Terminal multiplexer. It allows multiple sessions with windows, panes, and more.More information: https://github.com/tmux/tmux.

 - Start a new session:
   tmux

 - Start a new named session:
   tmux new -s {{name}}

 - List existing sessions:
   tmux ls

 - Attach to the most recently used session:
   tmux attach

 - Detach from the current session (inside a tmux session):
   Ctrl-B d

 - Create a new window (inside a tmux session):
   Ctrl-B c

 - Switch between sessions and windows (inside a tmux session):
   Ctrl-B w

 - Kill a session by name:
   tmux kill-session -t {{name}}
```

## Tmux会话（session）

我们知道我们刚才只输入`tmux`其实是打开了一个**会话**（$\text{session}$），感觉就是在终端运行了一个程序，当然你可以开启多个会话，在每个会话里进行独立的工作，互不干扰.

你可以通过

```bash
tmux new -s new_session
```

来创建一个叫做`new_session`的会话（自定义命名便于管理）. 通过

```bash
tmux ls
```

命令来列举出现在正在运行的会话. 其余命令可以通过`tldr`和手册查询，因为会话并不能实现我们在[引言](https://welts.xyz/2021/03/18/tmux/#%E5%BC%95%E8%A8%80)中所需要的分屏功能。

## Tmux窗口（window）

Tmux可以将窗口分成多个窗格（pane），每个窗格运行不同的命令。以下命令都是在Tmux窗口中执行。

```bash
tmux split-window
```

这样会将窗口切割成上下两部分：

![split-window](/img/tmux-split.png)

但是这并不像$\text{Visual Studio Code}$那样能够通过鼠标点击切换光标所在的窗口，而是要通过命令或者[快捷键](https://welts.xyz/2021/03/18/tmux/#tmux%E5%BF%AB%E6%8D%B7%E9%94%AE)，快捷键会在后面介绍.

### Tmux窗口切换（光标切换）

你可以通过下面的命令实现窗口光标的移动：

```bash
tmux select-pane -U  # 窗口光标移动到上面的窗口
tmux select-pane -D  # 窗口光标移动到上面的窗口
tmux select-pane -L  # 窗口光标移动到左边的窗口
tmux select-pane -R  # 窗口光标移动到右边的窗口
```

> 显然上面的命令很繁琐，我们可以在`~/.bashrc`（`zsh`用户则是`~/.zshrc`）中加入：
>
> ```bash
> alias tmuxu="tmux select-pane -U" 
> alias tmuxd="tmux select-pane -D" 
> alias tmuxl="tmux select-pane -L" 
> alias tmuxr="tmux select-pane -R" 
> ```
>
> 来简化命令

### Tmux分屏

我们刚才只是将屏幕分割成上下两部分，但像下面这样才能保证终端内容和终端数量取得平衡：

![tmux四分屏](/img/tmux4.png)

我们只需要在前面的命令`tmux split-windows`后面加一个参数即可实现将屏幕进行左右划分：

```bash
tmux split-windows -h
```

我们还是可以将命令简化：

```bash
alias splitv="tmux split-window"
alias splith="tmux split-wondow -h"
```

分别表示两种切割方法.

## Tmux快捷键

Tmux还有一个亮点是可以通过快捷键操作，减少了命令行输入这一死板的操作，但前提是我们要记得这些（组合）快捷键，在此列举一些快捷键的常用操作：

```text
Ctrl+b %：划分左右两个窗格。
Ctrl+b "：划分上下两个窗格。
Ctrl+b <arrow key>：光标切换到其他窗格。<arrow key>是指向要切换到的窗格的方向键，比如切换到下方窗格，就按方向键↓。
Ctrl+b ;：光标切换到上一个窗格。
Ctrl+b o：光标切换到下一个窗格。
Ctrl+b {：当前窗格与上一个窗格交换位置。
Ctrl+b }：当前窗格与下一个窗格交换位置。
Ctrl+b Ctrl+o：所有窗格向前移动一个位置，第一个窗格变成最后一个窗格。
Ctrl+b Alt+o：所有窗格向后移动一个位置，最后一个窗格变成第一个窗格。
Ctrl+b x：关闭当前窗格。
Ctrl+b !：将当前窗格拆分为一个独立窗口。
Ctrl+b z：当前窗格全屏显示，再使用一次会变回原来大小。
Ctrl+b Ctrl+<arrow key>：按箭头方向调整窗格大小。
Ctrl+b q：显示窗格编号。
```

只要稍加使用就会发现，这种组合快捷键模式不一定比简化后的命令方便多少。笔者更喜欢简化命令这一操作.

## 总结

显然如此简短的文章无法总结tmux的全部用法，但至少已经能满足笔者的需要（即分屏工作），若想了解更多可以去：

- [Tmux使用教程](https://www.ruanyifeng.com/blog/2019/10/tmux.html)
- [Tmux快捷键速查表](https://gist.github.com/ryerh/14b7c24dfd623ef8edc7)
- [Tmux官方wiki](https://github.com/tmux/tmux/wiki)

查询.
